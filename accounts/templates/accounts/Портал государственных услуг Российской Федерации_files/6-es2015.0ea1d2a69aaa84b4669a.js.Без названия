(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"0FX9":function(t,e,n){var r=n("Z92M"),i=n("qmMu"),o=n("QUaw"),s=n("QAZZ");function a(t,e,n,o,s){var a=[].slice.call(arguments,1),c=a.length,u="function"==typeof a[c-1];if(!u&&!r())throw new Error("Callback required as last argument");if(!u){if(c<1)throw new Error("Too few arguments provided");return 1===c?(n=e,e=o=void 0):2!==c||e.getContext||(o=n,n=e,e=void 0),new Promise((function(r,s){try{var a=i.create(n,o);r(t(a,e,o))}catch(c){s(c)}}))}if(c<2)throw new Error("Too few arguments provided");2===c?(s=n,n=e,e=o=void 0):3===c&&(e.getContext&&void 0===s?(s=o,o=void 0):(s=o,o=n,n=e,e=void 0));try{var l=i.create(n,o);s(null,t(l,e,o))}catch(d){s(d)}}e.create=i.create,e.toCanvas=a.bind(null,o.render),e.toDataURL=a.bind(null,o.renderToDataURL),e.toString=a.bind(null,(function(t,e,n){return s.render(t,n)}))},"0LtY":function(t,e){!function(t){t.IFCPlugin=function(e,n,r){var i="",o=null;function s(t){if(document.createEvent){var e=document.createEvent("Event");e.initEvent(t,!0,!0),document.dispatchEvent(e)}else document.documentElement[t]++}function a(){var t=navigator.userAgent;if(-1!==t.search("Safari")&&-1!==t.search("Version")){var e=t.indexOf("Version")+8,n=t.substr(e);if(n){var r=e+n.indexOf(".");if((n?parseInt(t.substring(e,r),10):0)>=12)return!0}}return!1}function c(){for(var t=navigator.userAgent,e=["Firefox","Chrome","Opera","Edge","YaBrowser","Safari"],n=0;n<e.length;n++){if(-1!==t.search(e[n])&&"Firefox"===e[n]){var r=t.indexOf(e[n])+8,i=t.substr(r);if(i){var o=r+i.indexOf(".");if((i?parseInt(t.substring(r,o),10):0)>=50)return!0}break}if(-1!==t.search(e[n])&&"Safari"===e[n]&&-1!==t.search("Version")){var s=t.indexOf("Version")+8,a=t.substr(s);if(a){var c=s+a.indexOf(".");if((a?parseInt(t.substring(s,c),10):0)>=12)return!0}break}if(-1!==t.search(e[n]))return!0}return!1}function u(t,e){o.send({func_name:"get_list_info",params:{cryptoType:t}},(function(n){if(IFCError.IFC_OK===n.error_code){for(var r=[],i=0;i<n.ifc_list.length;i++)n.ifc_list[i].type!==t&&null!=t||r.push(new IFCCrypto(n.ifc_list[i]));e({error_code:IFCError.IFC_OK,ifc_list:r})}else e(n)}))}function l(t){return u(null,t)}function d(t,e){l((function(n){if(IFCError.IFC_OK===n.error_code){for(var r=0;r<n.ifc_list.length;r++)if(t===n.ifc_list[r].getCryptoId())return void e({error_code:IFCError.IFC_OK,crypto:n.ifc_list[r]});e({error_code:IFCError.IFC_CRYPTO_NOT_FOUND,crypto})}else e(n)}))}function h(t){if(!t)return"";for(var e=["CryptoPro","VIPNet","SignalCom","LISSI-CSP"],n=0;n<e.length;n++)if(t.indexOf(e[n])>=0)return t.substring(0,t.indexOf("/"));return t.substring(0,t.lastIndexOf("/"))}function g(t,e,n,r,i,s,a){d(h(t),(function(c){IFCError.IFC_OK===c.error_code?(void 0===a&&(a=IFCConst.IFC_SHOW_CSP_UI),o.send({func_name:"sign",params:{containerId:t,userPin:e||"",inDataType:r,data:n,hashType:IFCConst.IFC_HARDWARE_HASH,signType:i,cspUI:a,outDataType:IFCConst.IFC_BASE64}},s)):s(c)}))}function p(t,e,n,r,i,s,a){s?F(s,(function(s){if(IFCError.IFC_OK===s.error_code){var c=s.x509Handle;o.send({func_name:"verify",params:{containerId:t,inDataType:i,data:r,signType:n,sign:e,x509Handle:c}},(function(t){var e,n=t.error_code;IFCError.IFC_OK===t.error_code&&(e=t.verify_result),T(c,(function(t){IFCError.IFC_OK===t.error_code?a({error_code:n,verify_result:e}):a(t)}))}))}else a(s)})):o.send({func_name:"verify",params:{containerId:t,inDataType:i,data:r,signType:n,sign:e,x509Handle:0}},a)}function f(t,e,n,r,i,s,a,c){d(h(t),(function(u){IFCError.IFC_OK===u.error_code?(void 0===c&&(c=1),o.send({func_name:"sign_xml",params:{containerId:t,userPin:e||"",wsu_id:n,inDataType:i,data:r,cspUI:c,outDataType:s}},a)):a(u)}))}function C(t,e,n,r,i){o.send({func_name:"verify_xml",params:{containerId:t,wsu_id:e,inDataType:r,sign:n}},(function(t){IFCError.IFC_OK===t.error_code?i({error_code:t.error_code,verify_result:t.verify_result}):i(t)}))}function I(t,e,n,r){o.send({func_name:"hash",params:{containerId:t,inDataType:e,data:n,outDataType:IFCConst.IFC_BASE64}},(function(t){IFCError.IFC_OK===t.error_code?r({error_code:IFCError.IFC_OK,hash:new IFCHash(t.hashValue)}):r(t)}))}function _(t,e){l((function(n){if(IFCError.IFC_OK===n.error_code){for(var r=n.ifc_list,i=[],s=0;s<r.length;s++)i.push(r[s].getCryptoId());o.send({func_name:"get_list_certs_by_cryptoid_array",params:{cryptoID_array:i,show_progress:e}},(function(e){if(IFCError.IFC_OK===e.error_code)if(e.intermediate)t(e);else{for(var n=[],i=0;i<e.result_array.length;i++){for(var o=!1,s=0;s<r.length;s++)if(r[s].getCryptoId()===e.result_array[i].crypto_id){o=r[s];break}if(!1!==o)for(var a=0;a<e.result_array[i].cert_list.length;a++)n.push(new IFCCertificate(e.result_array[i].cert_list[a],o))}t({error_code:IFCError.IFC_OK,certs_list:n})}else t(e)}))}else t(n)}))}function m(t,e,n,r,i){d(h(t),(function(s){IFCError.IFC_OK===s.error_code?e&&e.length>0||!s.crypto.isPKCS11()?function(t,e,n,r,i,s,a){o.send({func_name:"key_gen",params:{containerId:t,userPin:e}},(function(t){if(IFCError.IFC_OK===t.error_code){var c=new IFCDN(n,IFCConst.DN_SEPARATOR_INPUT).getSubjectArray(),u=("clientAuth,emailProtection,1.2.643.2.2.34.6,"+r).split(","),l=i.split(","),d=t.real_id;o.send({func_name:"req_gen",params:{containerId:d,userPin:e,subject:c,extendedKeyUsage:u,certificatePolicies:l,signInstrument:"",req_format:IFCConst.IFC_REQ_BASE64ENCODED,csrExtensions:s}},(function(t){IFCError.IFC_OK===t.error_code?a({error_code:IFCError.IFC_OK,real_id:d,req_base64_length:t.req_base64_length,req_base64:t.req_base64,req:new IFCCertificateRequest(d,t.req_base64)}):a(t)}))}else a(t)}))}(t,e,n,s.crypto.getExtendedKeyUsage(),s.crypto.getCertificatePolicies(),r,i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):i(s)}))}function E(t){o.send({func_name:"get_guid",params:{prefix:i}},t)}function S(t,e,n,r,i){E((function(o){if(IFCError.IFC_OK===o.error_code)return m(t+"/"+o.guid,e,n,r,i);i(o)}))}function v(t,e,n){d(h(t),(function(r){IFCError.IFC_OK===r.error_code?e&&e.length>0||!r.crypto.isPKCS11()?o.send({func_name:"key_delete",params:{containerId:t,userPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):n(r)}))}function F(t,e){o.send({func_name:"load_x509_from_data",params:{cert:t,cert_data_type:IFCConst.IFC_CERT_UNKNOWN}},e)}function T(t,e){o.send({func_name:"free_x509",params:{x509Handle:t}},e)}function y(t,e,n,r){n&&n.length>0?o.send({func_name:"p11_key_rename",params:{containerId:t,newContainerId:e,userPin:n}},r):r({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}this.status=null,this.safariExtensionScheme="safariExtension://",this.listenPluginEvent=function(t,e){document.addEventListener?document.addEventListener(t,e,!1):document.documentElement.attachEvent("onpropertychange",(function(n){n.propertyName===t&&e()}))},o=c()?new function(){var e=t,n=!1,r=!1;function i(t){if(t.source===e)try{var i=JSON.parse(t.data);i.type&&"FROM_IFC_EXT"===i.type?function(t){if(t.intermediate)n(t);else if(n){var e=n;n=!1,e(t)}}(i.msg_data):i.type&&"IFC_EXT_DISCONNECT"===i.type&&function(){if(n){var t=n;n=!1,t({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}r=!1}()}catch(o){}}this.send=function(t,o){if(n)o({error_code:IFCError.IFC_GENERAL_ERROR});else{var s=function(){if(r)return IFCError.IFC_OK;try{e.addEventListener("message",i,!1)}catch(t){return IFCError.IFC_PLUGIN_UNDEFINED_ERROR}return r=!0,IFCError.IFC_OK}();s===IFCError.IFC_OK?function(t,r){n=r;try{e.postMessage(JSON.stringify({type:"TO_IFC_EXT",msg_data:t}),"*")}catch(i){n=!1,r({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}(t,o):o({error_code:s})}}}:new function(t){t=t,this.send=function(e,n){try{t.post_message(JSON.stringify(e),(function(t,e){n(JSON.parse(e))}))}catch(r){n({error_code:IFCError.IFC_PLUGIN_UNDEFINED_ERROR})}}}(e),this.init=function(t){var e=this;this.status={isNativeMessaging:c(),isNewSafari:a(),extensionIsInstalled:null,pluginIsRunning:null},this.status.isNativeMessaging?setTimeout((function(){document.getElementById("ifcplugin-extension-is-installed")?(e.status.extensionIsInstalled=!0,e.status.pluginIsRunning=!!document.getElementById("ifc-plugin-is-installed")):e.status.extensionIsInstalled=!1,s("updatePluginStatus")}),t?this.status.isNewSafari?5e3:500:4):(this.status.pluginIsRunning=!1,this.getPluginVersion((function(t){IFCError.IFC_OK===t.error_code&&(e.status.pluginIsRunning=!0)})),setTimeout((function(){s("updatePluginStatus")}),1e3)),setTimeout(e.init.bind(e),5e3)},this.getLibVersion=function(t){return"2.2.1"},this.create=function(t,e,n){o.send({func_name:"create",params:{file_config:t,config_string:e,log_file_location:"",plugin_log_level:""}},n)},this.getPluginVersion=function(t){o.send({func_name:"version"},t)},this.getCryptoList=function(t){return l(t)},this.getPKCS11CryptoList=function(t){return u(IFCConst.IFC_CRYPTO_PKCS11,t)},this.getCAPICryptoList=function(t){return u(IFCConst.IFC_CRYPTO_CAPI,t)},this.getCAPILINUXCryptoList=function(t){return u(IFCConst.IFC_CRYPTO_CAPI_LINUX,t)},this.getCryptoById=function(t,e){return d(t,e)},this.getCertificateList=function(t){return _(t,0)},this.getCertificateListWithProgress=function(t){return _(t,1)},this.getCertificateListByCryptoId=function(t,e){return function(t,e){d(t,(function(t){if(IFCError.IFC_OK===t.error_code){var n=t.crypto;o.send({func_name:"get_list_certs",params:{cryptoID:n.getCryptoId()}},(function(t){if(IFCError.IFC_OK===t.error_code){certsArray=[];for(var r=0;r<t.cert_list.length;r++)certsArray.push(new IFCCertificate(t.cert_list[r],n));e({error_code:IFCError.IFC_OK,certs_list:certsArray})}else e(t)}))}else e(t)}))}(t,e)},this.getKeyListByCryptoId=function(t,e,n){return function(t,e,n){d(t,(function(t){if(IFCError.IFC_OK===t.error_code){var r=t.crypto;e&&e.length>0||!r.isPKCS11()||n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}),o.send({func_name:"get_list_keys",params:{cryptoID:r.getCryptoId(),userPin:e}},(function(t){if(IFCError.IFC_OK===t.error_code){keysArray=[];for(var e=0;e<t.keys_list.length;e++)keysArray.push(new IFCCertificate(t.keys_list[e],r));n({error_code:IFCError.IFC_OK,keys_list:keysArray})}else n(t)}))}else n(t)}))}(t,e,n)},this.getCryptoIdByContainerId=function(t){return h(t)},this.signDataXml=function(t,e,n,r,i,o,s){return f(t,e,n,r,IFCConst.IFC_DATATYPE_DATA,i,o,s)},r&&(this.verifyDataXml=function(t,e,n,r){return C(t,e,n,IFCConst.IFC_DATATYPE_DATA,r)}),this.signDataBase64Xml=function(t,e,n,r,i,o,s){return f(t,e,n,r,IFCConst.IFC_DATATYPE_DATA_BASE64,i,o,s)},r&&(this.verifyDataBase64Xml=function(t,e,n,r){return C(t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,r)}),this.signDataCmsAttached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,r,i)},r&&(this.verifyDataCmsAttached=function(t,e,n){return p(t,e,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataCmsDetached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,r,i)},r&&(this.verifyDataCmsDetached=function(t,e,n,r){return p(t,e,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,IFCConst.IFC_DATATYPE_DATA,"",r)}),this.signDataCadesBesAttached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,r,i)},r&&(this.verifyDataCadesBesAttached=function(t,e,n){return p(t,e,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA,"",n)}),this.signDataCadesBesDetached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,r,i)},r&&(this.verifyDataCadesBesDetached=function(t,e,n,r){return p(t,e,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,IFCConst.IFC_DATATYPE_DATA,"",r)}),this.signDataBase64CmsAttached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,r,i)},r&&(this.verifyDataBase64CmsAttached=function(t,e,n){return p(t,e,IFCConst.IFC_SIGNTYPE_CMS_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataBase64CmsDetached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,r,i)},r&&(this.verifyDataBase64CmsDetached=function(t,e,n,r){return p(t,e,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,IFCConst.IFC_DATATYPE_DATA_BASE64,"",r)}),this.signDataBase64CadesBesAttached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,r,i)},r&&(this.verifyDataBase64CadesBesAttached=function(t,e,n){return p(t,e,IFCConst.IFC_SIGNTYPE_CADES_BES_ATTACHED,"",IFCConst.IFC_DATATYPE_DATA_BASE64,"",n)}),this.signDataBase64CadesBesDetached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,r,i)},r&&(this.verifyDataBase64CadesBesDetached=function(t,e,n,r){return p(t,e,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,IFCConst.IFC_DATATYPE_DATA_BASE64,"",r)}),this.signDataHash64CmsDetached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,r,i)},r&&(this.verifyDataHash64CmsDetached=function(t,e,n,r){return p(t,e,IFCConst.IFC_SIGNTYPE_CMS_DETACHED,n,IFCConst.IFC_DATATYPE_HASH_BASE64,"",r)}),this.signDataHash64CadesBesDetached=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,r,i)},r&&(this.verifyDataHash64CadesBesDetached=function(t,e,n,r){return p(t,e,IFCConst.IFC_SIGNTYPE_CADES_BES_DETACHED,n,IFCConst.IFC_DATATYPE_HASH_BASE64,"",r)}),this.signDataSimple=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE,r,i)},r&&(this.verifyDataSimple=function(t,e,n,r,i){return p(t,e,IFCConst.IFC_SIGNTYPE_SIMPLE,n,IFCConst.IFC_DATATYPE_DATA,r,i)}),this.signHashSimple=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_HASH_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,r,i)},r&&(this.verifyHashSimple=function(t,e,n,r,i){return p(t,e,IFCConst.IFC_SIGNTYPE_SIMPLE,n,IFCConst.IFC_DATATYPE_HASH_BASE64,r,i)}),this.signDataSimpleReversed=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,r,i)},r&&(this.verifyDataSimpleReversed=function(t,e,n,r,i){return p(t,e,IFCConst.IFC_SIGNTYPE_SIMPLE_REVERSE,n,IFCConst.IFC_DATATYPE_DATA,r,i)}),this.signDataBase64Simple=function(t,e,n,r,i){return g(t,e,n,IFCConst.IFC_DATATYPE_DATA_BASE64,IFCConst.IFC_SIGNTYPE_SIMPLE,r,i)},r&&(this.verifyDataBase64Simple=function(t,e,n,r,i){return p(t,e,IFCConst.IFC_SIGNTYPE_SIMPLE,n,IFCConst.IFC_DATATYPE_DATA_BASE64,r,i)}),this.generateKeyPairAndCsrForContainerId=function(t,e,n,r){return function(t,e,n,r){return m(t,e,n,"",r)}(t,e,n,r)},this.generateKeyPairAndCsrForContainerIdV2=function(t,e,n,r,i){return m(t,e,n,r,i)},this.generateKeyPairAndCsr=function(t,e,n,r){return function(t,e,n,r){return S(t,e,n,"",r)}(t,e,n,r)},this.generateKeyPairAndCsrV2=function(t,e,n,r,i){return S(t,e,n,r,i)},r&&(this.makeSelfSignedCert=function(t,e,n,r){return function(t,e,n,r){d(h(t),(function(i){IFCError.IFC_OK===i.error_code?e&&e.length>0||!i.crypto.isPKCS11()?o.send({func_name:"make_cert",params:{containerId:t,userPin:e,request:n}},(function(t){r(t)})):r({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):r(i)}))}(t,e,n,r)}),this.putCertificate=function(t,e,n,r){return function(t,e,n,r){d(h(t),(function(i){IFCError.IFC_OK===i.error_code?e&&e.length>0||!i.crypto.isPKCS11()?F(n,(function(n){if(IFCError.IFC_OK===n.error_code){var i=n.x509Handle;o.send({func_name:"set_x509",params:{containerId:t,userPin:e,x509Handle:i}},(function(t){IFCError.IFC_OK===t.error_code?T(i,(function(t){r(t)})):r(t)}))}else r(n)})):r({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR}):r(i)}))}(t,e,n,r)},this.deleteContainer=function(t,e,n){return v(t,e,n)},this.getGuid=function(t){return E(t)},this.setGuidPrefix=function(t){i=t},this.getGuidPrefix=function(){return i},this.getCertificate=function(t,e){return function(t,e){!function(t,e){o.send({func_name:"load_x509_from_container",params:{containerId:t}},e)}(t,(function(t){if(IFCError.IFC_OK===t.error_code){var n=t.x509Handle;o.send({func_name:"get_x509_info",params:{x509Handle:n}},(function(t){if(IFCError.IFC_OK===t.error_code){var r=new IFCCertificateInfo(t.cert_info);T(n,(function(t){e({error_code:t.error_code,cert:r})}))}else e(t)}))}else e(t)}))}(t,e)},this.getCertificateFromString=function(t,e){return function(t,e){F(t,(function(t){if(IFCError.IFC_OK===t.error_code){var n=t.x509Handle;!function(t,e){o.send({func_name:"get_x509_info",params:{x509Handle:t}},(function(t){if(IFCError.IFC_OK===t.error_code){var n=new IFCCertificateInfo(t.cert_info);e({error_code:t.error_code,cert:n})}else e(t)}))}(n,(function(t){if(IFCError.IFC_OK===t.error_code){var r=t.cert;T(n,(function(t){e({error_code:t.error_code,cert:r})}))}else e(t)}))}else e(t)}))}(t,e)},this.getHash=function(t,e,n){return I(t,IFCConst.IFC_DATATYPE_DATA,e,n)},this.getHashFromBase64=function(t,e,n){return I(t,IFCConst.IFC_DATATYPE_DATA_BASE64,e,n)},this.encrypt=function(t,e,n,r,i){return function(t,e,n,r,i){e&&e.length>0?F(n,(function(n){IFCError.IFC_OK===n.error_code?(peer_x509Handle=n.x509Handle,o.send({func_name:"encrypt",params:{containerId:t,userPin:e,peerX509Handle:peer_x509Handle,data:r}},(function(t){var e,n=t.error_code;IFCError.IFC_OK===t.error_code&&(e=new IFCEncrypted(t.enc_data_base64,t.enc_key_base64,t.cert_base64)),T(peer_x509Handle,(function(t){IFCError.IFC_OK===t.error_code?IFCError.IFC_OK===n?i({error_code:n,encrypted:e}):i({error_code:n}):i(t)}))}))):i(n)})):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n,r,i)},this.decrypt=function(t,e,n,r,i,s){return function(t,e,n,r,i,s){e&&e.length>0?F(n,(function(n){IFCError.IFC_OK===n.error_code?(peer_x509Handle=n.x509Handle,o.send({func_name:"decrypt",params:{containerId:t,userPin:e,peerX509Handle:peer_x509Handle,encryptedData:r,encryptedKey:i}},(function(t){var e,n=t.error_code;IFCError.IFC_OK===t.error_code&&(e=t.decrypted),T(peer_x509Handle,(function(t){IFCError.IFC_OK===t.error_code?IFCError.IFC_OK===n?s({error_code:n,decrypted:e}):s({error_code:n}):s(t)}))}))):s(n)})):s({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n,r,i,s)},this.pkcs11Init=function(t,e,n,r,i){return function(t,e,n,r,i){n&&n.length>0&&r&&r.length>0?o.send({func_name:"p11_init",params:{cryptoID:t,label:e,userPin:n,adminPin:r}},i):i({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n,r,i)},this.pkcs11ChangeUserPin=function(t,e,n,r){return function(t,e,n,r){e&&e.length>0&&n&&n.length>0?o.send({func_name:"p11_pin_change",params:{cryptoID:t,pinType:IFCConst.P11_PIN_TYPE_USER,currentPin:e,newPin:n}},r):r({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n,r)},this.pkcs11UnlockUserPin=function(t,e,n){return function(t,e,n){e&&e.length>0?o.send({func_name:"p11_pin_unlock",params:{cryptoID:t,adminPin:e}},n):n({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n)},this.pkcs11ChangeAdminPin=function(t,e,n,r){return function(t,e,n,r){e&&e.length>0&&n&&n.length>0?o.send({func_name:"p11_pin_change",params:{cryptoID:t,pinType:IFCConst.P11_PIN_TYPE_ADMIN,currentPin:e,newPin:n}},r):r({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n,r)},this.pkcs11RenameContainer=function(t,e,n,r){return y(t,e,n,r)},this.pkcs11MoveContainer=function(t,e,n,r){return function(t,e,n,r){n&&n.length>0?d(h(t),(function(i){IFCError.IFC_OK===i.error_code?null!=i.crypto&&i.crypto.isPKCS11()?v(h(t)+"/"+e,n,(function(i){IFCError.IFC_OK!==i.error_code&&IFCError.IFC_CONTAINER_NOT_FOUND!==i.error_code||y(t,e,n,r)})):r({error_code:IFCError.IFC_BAD_PARAMS}):r(i)})):r({error_code:IFCError.IFC_P11_INVALID_PIN_ERROR})}(t,e,n,r)},this.sendAPDU=function(t,e,n){return function(t,e,n){o.send({func_name:"send_apdu",params:{readerName:t,apdu_string:e}},n)}(t,e,n)}}}(window)},"1sBl":function(t,e,n){var r=n("e/Dd").getSymbolSize;e.getRowColCoords=function(t){if(1===t)return[];for(var e=Math.floor(t/7)+2,n=r(t),i=145===n?26:2*Math.ceil((n-13)/(2*e-2)),o=[n-7],s=1;s<e-1;s++)o[s]=o[s-1]-i;return o.push(6),o.reverse()},e.getPositions=function(t){for(var n=[],r=e.getRowColCoords(t),i=r.length,o=0;o<i;o++)for(var s=0;s<i;s++)0===o&&0===s||0===o&&s===i-1||o===i-1&&0===s||n.push([r[o],r[s]]);return n}},"3X7Y":function(t,e,n){var r=n("u/Db");function i(t){this.mode=r.NUMERIC,this.data=t.toString()}i.getBitsLength=function(t){return 10*Math.floor(t/3)+(t%3?t%3*3+1:0)},i.prototype.getLength=function(){return this.data.length},i.prototype.getBitsLength=function(){return i.getBitsLength(this.data.length)},i.prototype.write=function(t){var e,n,r;for(e=0;e+3<=this.data.length;e+=3)n=this.data.substr(e,3),r=parseInt(n,10),t.put(r,10);var i=this.data.length-e;i>0&&(n=this.data.substr(e),r=parseInt(n,10),t.put(r,3*i+1))},t.exports=i},"7uVY":function(t,e){var n={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==n.call(t)}},AZa5:function(t,e,n){var r=n("Wogr"),i=n("u/Db");function o(t){this.mode=i.BYTE,this.data=new r(t)}o.getBitsLength=function(t){return 8*t},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(t){for(var e=0,n=this.data.length;e<n;e++)t.put(this.data[e],8)},t.exports=o},BCVQ:function(t,e){var n="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",r="(?:(?![A-Z0-9 $%*+\\-./:]|"+(n=n.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";e.KANJI=new RegExp(n,"g"),e.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),e.BYTE=new RegExp(r,"g"),e.NUMERIC=new RegExp("[0-9]+","g"),e.ALPHANUMERIC=new RegExp("[A-Z $%*+\\-./:]+","g");var i=new RegExp("^"+n+"$"),o=new RegExp("^[0-9]+$"),s=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");e.testKanji=function(t){return i.test(t)},e.testNumeric=function(t){return o.test(t)},e.testAlphanumeric=function(t){return s.test(t)}},ELBg:function(t,e,n){"use strict";var r={single_source_shortest_paths:function(t,e,n){var i={},o={};o[e]=0;var s,a,c,u,l,d,h=r.PriorityQueue.make();for(h.push(e,0);!h.empty();)for(c in u=(s=h.pop()).cost,l=t[a=s.value]||{})l.hasOwnProperty(c)&&(d=u+l[c],(void 0===o[c]||o[c]>d)&&(o[c]=d,h.push(c,d),i[c]=a));if(void 0!==n&&void 0===o[n]){var g=["Could not find a path from ",e," to ",n,"."].join("");throw new Error(g)}return i},extract_shortest_path_from_predecessor_list:function(t,e){for(var n=[],r=e;r;)n.push(r),r=t[r];return n.reverse(),n},find_path:function(t,e,n){var i=r.single_source_shortest_paths(t,e,n);return r.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(t){var e,n=r.PriorityQueue,i={};for(e in t=t||{},n)n.hasOwnProperty(e)&&(i[e]=n[e]);return i.queue=[],i.sorter=t.sorter||n.default_sorter,i},default_sorter:function(t,e){return t.cost-e.cost},push:function(t,e){this.queue.push({value:t,cost:e}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};t.exports=r},Hq07:function(t,e,n){"use strict";n.r(e),n.d(e,"LoginModule",(function(){return Ge}));var r=n("ofXK"),i=n("tyNb"),o=n("Gk2f"),s=n("3Pt+"),a=n("bOGp"),c=n("cvmq"),u=n("HrSU"),l=n("I8Zc"),d=n("SfxQ"),h=n("8iAA"),g=n("CHA6"),p=n("fXoL"),f=n("BmY/"),C=n("j0Qm"),I=n("e1ef"),_=n("yA8g"),m=n("sYmb");function E(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"esia-input",9),p["\u0275\u0275listener"]("keyup.enter",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().check()}))("keyup.space",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().check()})),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("labelText",p["\u0275\u0275pipeBind1"](2,4,"OTP.CODE"))("name",p["\u0275\u0275pipeBind1"](3,6,"OTP.CODE"))("invalid",t.invalidCode)("autocomplete","one-time-code")}}function S(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",10),p["\u0275\u0275elementStart"](1,"esia-code-input",11),p["\u0275\u0275listener"]("checkValue",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().check(e)}))("changeValue",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().hideError()}))("equalToPreviousValue",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"]();return e.setError(e.errorStateTypes.WrongTtp)})),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("labelText",p["\u0275\u0275pipeBind1"](2,2,"OTP.CODE"))("length",t.length)}}function v(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",12),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](2,1,"TTP.INVALID_LABEL")," "))}function F(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",13),p["\u0275\u0275elementStart"](1,"button",14),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().check()})),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("disabled",t.form.invalid||t.code.value===t.previousCode),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,2,"TTP.CONTINUE")," ")}}let T=(()=>{class t{constructor(t,e){this.config=t,this.changeDetector=e,this.checkCode=new p.EventEmitter,this.goBackEvent=new p.EventEmitter,this.previousCode="",this.esiaConfig=this.config.params,this.codeTypeFree=g.b.Free}get errorStateTypes(){return o.b}get code(){return this.form.get("code")}get invalidCode(){return!this.code.pristine&&"invalid_ttp"===this.state||this.errorState===this.errorStateTypes.WrongTtp}ngOnInit(){this.form=new s.FormGroup({code:new s.FormControl("",[s.Validators.required])})}check(t){this.previousCode=this.code.value,this.checkCode.emit(t||this.code.value)}clearCodeInput(){this.codeInput&&this.codeInput.clearValue()}setError(t){t&&this.clearCodeInput(),this.errorState=t,this.changeDetector.markForCheck()}hideError(){this.setError(null)}goBack(){this.goBackEvent.emit()}}return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275directiveInject"](C.a),p["\u0275\u0275directiveInject"](p.ChangeDetectorRef))},t.\u0275cmp=p["\u0275\u0275defineComponent"]({type:t,selectors:[["esia-ttp"]],viewQuery:function(t,e){var n;1&t&&p["\u0275\u0275viewQuery"](f.a,!0),2&t&&p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(e.codeInput=n.first)},inputs:{state:"state",errorState:"errorState",description:"description",codeType:"codeType",length:"length"},outputs:{checkCode:"checkCode",goBackEvent:"goBackEvent"},decls:12,vars:11,consts:[[3,"handler"],[3,"formGroup"],[1,"title-h3","text-center","mb-24",3,"innerHTML"],[1,"text-plain","text-center","mb-24",3,"innerHTML"],[1,"input-control"],[4,"ngIf","ngIfElse"],["codeLength",""],["class","error-label mt-8",4,"ngIf"],["class","mt-24",4,"ngIf"],["id","code","formControlName","code",3,"labelText","name","invalid","autocomplete","placeholder","keyup.enter","keyup.space"],[1,"mt-40"],[3,"labelText","length","checkValue","changeValue","equalToPreviousValue"],[1,"error-label","mt-8"],[1,"mt-24"],["type","button",1,"plain-button","plain-button_wide","wide",3,"disabled","click"]],template:function(t,e){if(1&t&&(p["\u0275\u0275elementStart"](0,"esia-back-button",0),p["\u0275\u0275listener"]("handler",(function(){return e.goBack()})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](1,"form",1),p["\u0275\u0275element"](2,"h3",2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275element"](4,"div",3),p["\u0275\u0275pipe"](5,"translate"),p["\u0275\u0275elementStart"](6,"div",4),p["\u0275\u0275template"](7,E,4,8,"ng-container",5),p["\u0275\u0275template"](8,S,3,4,"ng-template",null,6,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275template"](10,v,3,3,"div",7),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](11,F,4,4,"div",8),p["\u0275\u0275elementEnd"]()),2&t){const t=p["\u0275\u0275reference"](9);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("formGroup",e.form),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](3,7,"TTP.TITLE"),p["\u0275\u0275sanitizeHtml"]),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](5,9,"TTP.DESCRIPTION"),p["\u0275\u0275sanitizeHtml"]),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",e.codeType===e.codeTypeFree||!e.esiaConfig.autosentcode)("ngIfElse",t),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",e.invalidCode),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",e.codeType===e.codeTypeFree)}},directives:[I.a,s["\u0275angular_packages_forms_forms_y"],s.NgControlStatusGroup,s.FormGroupDirective,r.t,_.a,s.NgControlStatus,s.FormControlName,f.a],pipes:[m.d],styles:[""],changeDetection:0}),t})();var y=n("1G5W"),A=n("vkgz"),D=n("pLZG"),O=n("IzEk"),N=n("tSjf"),w=function(t){return t.Windows="Windows",t.Mac="Mac",t.Linux="Linux",t}({}),R=n("2Vo4"),P=n("55/F"),b=n("WHFS"),x=n("LG1p"),L=n("95Ly"),B=n("l3Vr"),k=n("OUbo"),M=n("S2y7"),V=n("0C3n"),G=n("ABZj"),U=n("hI/h");n("0LtY"),n("PhFw");let Y=(()=>{class t{constructor(){}static dateToStr(t){const e=t.split(" "),n=[];for(const r in e)e[r]&&" "!==e[r]&&n.push(e[r]);return new Date(n[0]+" "+n[1]+" "+n[3]+" "+n[2]+" "+n[4])}static dateFormat(t){const e=t.getUTCDate(),n=t.getUTCMonth()+1;return(e>9?e:"0"+e)+"."+(n>9?n:"0"+n)+"."+t.getUTCFullYear()}static cspId(t){switch(t.type){case"capi":return t.alias;case"pkcs11":return t.alias+"/"+t.num;default:return t.crypto_id}}static parseDn(t){const e={},n=t.split("\n");for(const r of n){const t=r.split("=");e[t[0].trim().toLocaleLowerCase()]=t[1].trim()}return e}static getCryptoIdByContainerId(t){return t.indexOf("CryptoPro")>=0||t.indexOf("VIPNet")>=0?t.substring(0,t.indexOf("/")):t.substring(0,t.lastIndexOf("/"))}static removeIfc(t){const e=document.getElementById(t);"object"==typeof e&&e.parentNode?e.parentNode.removeChild(e):e&&document.body.removeChild(e)}version(){return this.instance||this.init(),this.instance.version}init(){const e="ifcplugin",n=document.createElement("object");if(n.setAttribute("id",e),n.setAttribute("type","application/x-ifcplugin"),n.setAttribute("height","1"),n.setAttribute("width","1"),document.body.appendChild(n),!n.valid||"function"!=typeof n.create&&"object"!=typeof n.create)throw t.removeIfc(e),new Error("ds_plugin_not_found");if(0!==n.create())throw t.removeIfc(e),new Error("ds_plugin_internal");this.instance=n}crtString(t){if(this.instance.info_x509(this.instance.load_x509_from_container(t),1,[]),0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");return"info".info}parseCrt(e,n){const r="subject",i="common_name",o={validity:{},issuer:{},subject:{},sort:{},filter:{}},s=t.parseDn(e.cert_subject),a=t.parseDn(e.cert_issuer);o.id=t.cspId(n)+"/"+e.id,o.serial_number=e.cert_sn,o.validity.from=t.dateFormat(t.dateToStr(e.cert_valid_from)),o.validity.to=t.dateFormat(t.dateToStr(e.cert_valid_to)),o.issuer[i]=void 0!==a.commonname?a.commonname:a.cn,o[r][i]=void 0!==s.commonname?s.commonname:s.cn,o[r].sn=null!=s.surname?s.surname:"",o[r].gn=null!=s.givenname?s.givenname:"",o.string=this.crtString(o.id),o.type=o[r].sn.length>0?"extended":"base",o.sort.from=t.dateToStr(e.cert_valid_from),o.filter.to=t.dateToStr(e.cert_valid_to),o.filter.csp_type=n.type,void 0!==o.issuer[i]&&o.issuer[i]&&(o.issuer[i]=o.issuer[i].replace("_"," ")),void 0!==o[r][i]&&o[r][i]&&(o[r][i]=o[r][i].replace("_"," "));const c=o[r].sn;return void 0!==c&&c&&(o[r].sn=o[r].sn.replace("_"," ")),void 0!==o[r].gn&&o[r].gn&&(o[r].gn=o[r].gn.replace("_"," ")),o}crts(){const e=[],n=this.instance.get_list_info_size();if(0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");for(let r=0;r<n;r++){const n=[];if(this.instance.get_list_info(r,n),0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");const i=this.instance.get_list_certs_size(t.cspId(n));if(0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");for(let t=0;t<i;t++){const r=[];if(this.instance.get_list_certs(t,r),0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");e.push(this.parseCrt(r,n))}}return e.sort((t,e)=>t.sort.from<e.sort.from?1:t.sort.from>e.sort.from?-1:0),e.filter(t=>t.filter.to>=new Date)}crtInfo(t){const e=this.crts();for(const n of e)if(n.id===t)return n;throw new Error("ds_plugin_container_not_found")}isPinRequired(e){const n=t.getCryptoIdByContainerId(e),r=this.instance.get_list_info_size();if(0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");for(let i=0;i<r;i++){const e="type",r=[];if(this.instance.get_list_info(i,r),0!==this.instance.get_last_error())throw new Error("ds_plugin_internal");if(n===t.cspId(r))return"pkcs11"===r[e]}throw new Error("ds_plugin_container_not_found")}sign(t,e,n){const r=[];switch(this.instance.sign(t,e,n,1,1,1,3,r),this.instance.get_last_error()){case 0:return r.sign_base64;case 1:throw new Error("ds_plugin_process_interrupted");case 25:throw new Error("ds_plugin_container_not_found");case 160:throw new Error("ds_plugin_bad_pin");default:throw new Error("ds_plugin_internal")}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),q=(()=>{class t{constructor(t,e,n){this.zone=t,this.modalService=e,this.dsPlugin=n,this.certs=[]}static checkPin(t){if(null==t||0===t.trim().length)throw new Error("ds_plugin_bad_pin")}static removeIfc(t){"object"==typeof t&&t.parentNode?t.parentNode.removeChild(t):t&&document.body.removeChild(t)}static isChromeConnector(){const t=["Firefox/","Chrome","Opera","Edge","YaBrowser"],e=navigator.userAgent;let n=!1;for(const r of t){if(-1!==e.search(r)&&"Firefox/"===r){let t=e.indexOf(r);t+=8;let i=e.substr(t);if(i){const t=i.indexOf(" ");i=-1!==t?i.substring(0,t):i,(i?parseInt(i,10):0)>=50&&(n=!0)}break}if(-1!==e.search(r)){n=!0;break}}return n}static dsPluginErrorHandler(t,e){switch(t){case"ds_plugin_not_found":e({code:"plugin_not_found"});break;case"ds_plugin_internal":e({code:"internal"});break;case"ds_plugin_container_not_found":e({code:"container_not_found"});break;case"ds_plugin_process_interrupted":e({code:"process_interrupted"});break;default:throw t}}static normalizeVersionOctet(t){return void 0!==t&&null!=t?"000".substring(0,3-t.length)+t:"000"}static normalizeVersion(e){const n=void 0!==e&&null!=e?e.split("."):[];let r="1";for(let i=0;i<4;i++)r+=t.normalizeVersionOctet(n[i]);return parseInt(r,10)}static parseDate(t){const e=new Date(t),n=e.getUTCDate(),r=e.getUTCMonth()+1;return(n>9?n:"0"+n)+"."+(r>9?r:"0"+r)+"."+e.getUTCFullYear()}version(){return this.instance||this.dsPlugin.init(),{version:this.version,crts:this.certs,sign:this.sign}}checkPlugin(e,n,r){this.disclaimerDialog(),setTimeout(()=>{this.initIFCPlugin(t=>{this.certs=t.certs,e({version:t.version})},()=>{this.ifcPlugin=null;try{const n=this.dsPlugin.version();console.log(n),t.normalizeVersion(n)>=t.normalizeVersion(r)?e({version:n}):this.errorDialog("old_version")}catch(i){"ds_plugin_not_found"===i.message?this.errorDialog("not_found"):t.dsPluginErrorHandler(i,n)}})},2e3)}listDialog(e,n){setTimeout(()=>{let r;try{r=this.ifcPlugin?this.certs:this.dsPlugin.crts()}catch(i){return void t.dsPluginErrorHandler(i,n)}this.modalService.destroyForm(),this.modalService.popupInject(V.a,null,{items:r.map((e,n)=>({index:n,commonName:this.ifcPlugin?e.getSubjectDN().getCommonName():e.subject.common_name,issuer:this.ifcPlugin?e.getIssuerDN().getCommonName():e.issuer.common_name,subjectSurname:this.ifcPlugin?e.getSubjectDN().getSurname():e.subject.sn,subjectName:this.ifcPlugin?e.getSubjectDN().getGivenName():e.subject.gn,validFrom:this.ifcPlugin?t.parseDate(e.getValidFrom()):e.validity.from,validTo:this.ifcPlugin?t.parseDate(e.getValidTo()):e.validity.to})),select:t=>{this.ifcPlugin?this.ifcPlugin.getCertificate(r[t].getContainerId(),n=>{try{e({id:r[t].getContainerId(),certificate:n.cert})}catch(i){console.log("Invalid certificate. Container ID: "+r[t].getContainerId())}}):e({id:r[t].id,certificate:r[t].string})}})},2e3)}sign(e,n,r,i){let o;this.disclaimerDialog();let s=3;if(this.ifcPlugin)for(const t of this.certs)t.getContainerId()===e&&(o=t);else try{o=this.dsPlugin.crtInfo(e)}catch(c){return void t.dsPluginErrorHandler(c,i)}const a=u=>{setTimeout(()=>{try{if(this.ifcPlugin)this.ifcPlugin.signDataCmsAttached(e,u,n,t=>{window.IFCError.IFC_OK===t.error_code?r({sign:t.sign_value}):window.IFCError.IFC_BAD_TYPE_PIN!==t.error_code&&window.IFCError.IFC_P11_LOGIN_ERROR!==t.error_code||(s=s>0?s-1:0,this.pinDialog(o,a,s))});else{const t=this.dsPlugin.sign(e,u,n);r({sign:t})}}catch(c){"ds_plugin_bad_pin"===c?(s=s>0?s-1:0,this.pinDialog(o,a,s)):t.dsPluginErrorHandler(c,i)}},2e3)};setTimeout(()=>{if(this.ifcPlugin)this.pinDialog(o,a);else{let s;try{s=this.dsPlugin.isPinRequired(e)}catch(c){return void t.dsPluginErrorHandler(c,i)}if(s)this.pinDialog(o,a);else try{r({sign:this.dsPlugin.sign(e,"",n)})}catch(c){t.dsPluginErrorHandler(c,i)}}},2e3)}selectAndSign(t,e,n){this.listDialog(r=>{this.sign(r.id,t,t=>{t.id=r.id,t.certificate=r.certificate,e(t)},t=>{n(t)})},t=>{n(t)})}selectAndSignJsonXml(t,e,n,r){this.listDialog(e=>{this.sign(e.id,t,i=>{this.sign(e.id,t,t=>{n({jsonPkcs7:i.sign,xmlPkcs7:t.sign})},t=>{r(t)})},t=>{r(t)})},t=>{r(t)})}initIFCPlugin(e,n){const r=navigator.userAgent;r.search("Chrome")>-1||r.search("Firefox")>-1?document.getElementById("ifcplugin-extension-is-installed")&&document.getElementById("ifc-plugin-is-installed")?this.ifcLoad(!0,t=>{e(t)},()=>{n()}):n():this.ifcLoad(t.isChromeConnector(),t=>{e(t)},()=>{n()})}ifcLoad(e,n,r){let i;i=document.createElement("object"),i.setAttribute("id","IFCPlugin"),i.setAttribute("height","1"),i.setAttribute("width","1"),e||i.setAttribute("type","application/x-ifcplugin"),document.getElementById("IFCPlugin")||document.body.appendChild(i),this.ifcPlugin=new window.IFCPlugin(document.getElementById("IFCPlugin"),e,!0),this.ifcPlugin?(this.disclaimerDialog(),this.ifcPlugin.create("","",e=>{window.IFCError.IFC_OK===e.error_code?this.ifcPlugin.getPluginVersion(e=>{if(window.IFCError.IFC_OK===e.error_code){const r=e.version;console.log("VERSION: "+e.version),this.ifcPlugin.getCertificateList(e=>{let o=e.certs_list;o=o.filter(t=>t.isValid()),console.log("Is valid certificates: "+o.length),n({version:r,certs:o}),o.length||t.removeIfc(i)})}else t.removeIfc(i),r()}):(t.removeIfc(i),r())})):r()}errorDialog(t){this.modalService.destroyForm(),this.modalService.popupInject(l.a,null,{type:t})}pinDialog(e,n,r){this.zone.runTask(()=>{const i={commonName:this.ifcPlugin?e.getSubjectDN().getCommonName():e.subject.common_name,issuer:this.ifcPlugin?e.getIssuerDN().getCommonName():e.issuer.common_name,subjectSurname:this.ifcPlugin?e.getSubjectDN().getSurname():e.subject.sn,subjectName:this.ifcPlugin?e.getSubjectDN().getGivenName():e.subject.gn,validFrom:this.ifcPlugin?t.parseDate(e.getValidFrom()):e.validity.from,validTo:this.ifcPlugin?t.parseDate(e.getValidTo()):e.validity.to};this.modalService.destroyForm(),this.modalService.popupInject(G.a,null,{error:r,item:i,isPKCS11:e.isPKCS11(),submit:t=>{n(t),setTimeout(()=>{this.disclaimerDialog()})}})})}clearModals(){this.modalService.destroyForm()}disclaimerDialog(){this.zone.runTask(()=>{this.modalService.destroyForm(),this.modalService.popupInject(U.a,null)})}}return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275inject"](p.NgZone),p["\u0275\u0275inject"](b.a),p["\u0275\u0275inject"](Y))},t.\u0275prov=p["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),H=(()=>{class t{constructor(t,e){this.api=t,this.dsWidget=e,this.version="2.0.3.1"}checkPlugin(){return new Promise((t,e)=>{this.dsWidget.checkPlugin(t,e,this.version)})}sign(t){return new Promise((e,n)=>{this.dsWidget.selectAndSign(t,e,n)})}signJsonXml(t,e){return new Promise((n,r)=>{this.dsWidget.selectAndSignJsonXml(t,e,n,r)})}checkPluginAndSign(t,e){const n={};this.checkPlugin().then(e=>{this.api.getRequest("profile/rs/prns/usrcfm/ds-challenge").subscribe(e=>{n.__challenge=e.challenge,this.sign(e.challenge).then(e=>{n.__signature=e.sign,n.__certificate=e.certificate,t&&"function"==typeof t&&t(n)},t=>{})})},t=>{e&&"function"==typeof e&&e(t)})}closeModals(){this.dsWidget.clearModals()}}return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275inject"](M.a),p["\u0275\u0275inject"](q))},t.\u0275prov=p["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var j=n("b6Qw"),K=n("9YtQ"),z=n("b8Vu"),Q=n("F8Sv"),X=n("Eg8k"),W=n("Y6wK"),$=n("XNiG"),J=n("HDdC"),Z=n("3N8a");const tt=new(n("IjjT").a)(Z.a);var et=n("DH7j");function nt(t){return!Object(et.a)(t)&&t-parseFloat(t)+1>=0}var rt=n("z+Ro");function it(t){const{index:e,period:n,subscriber:r}=t;if(r.next(e),!r.closed){if(-1===n)return r.complete();t.index=e+1,this.schedule(t,n)}}var ot=n("Kqap"),st=n("7o/Q");class at{constructor(t,e){this.predicate=t,this.inclusive=e}call(t,e){return e.subscribe(new ct(t,this.predicate,this.inclusive))}}class ct extends st.a{constructor(t,e,n){super(t),this.predicate=e,this.inclusive=n,this.index=0}_next(t){const e=this.destination;let n;try{n=this.predicate(t,this.index++)}catch(r){return void e.error(r)}this.nextOrComplete(t,n)}nextOrComplete(t,e){const n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())}}class ut{constructor(t,e){this.cdr=e,this.stop$=new $.a,this.updateSeconds(t),this.timer=new R.a(this.seconds),this.timer$=this.timer.asObservable()}updateSeconds(t){this.seconds=t&&t>0?t:0}start(t){this.stop$.next(),null!=t&&this.updateSeconds(t),function(t=0,e,n){let r=-1;return nt(e)?r=Number(e)<1?1:Number(e):Object(rt.a)(e)&&(n=e),Object(rt.a)(n)||(n=tt),new J.a(e=>{const i=nt(t)?t:+t-n.now();return n.schedule(it,i,{index:0,period:r,subscriber:e})})}(0,1e3).pipe(Object(ot.a)(t=>t-1,this.seconds+1),function(t,e=!1){return n=>n.lift(new at(t,e))}(t=>t>=0),Object(y.a)(this.stop$)).subscribe(t=>{this.timer.next(t),this.cdr.detectChanges()})}stop(){this.stop$.next()}}var lt=n("xgIS");class dt{constructor(t,e){this.dueTime=t,this.scheduler=e}call(t,e){return e.subscribe(new ht(t,this.dueTime,this.scheduler))}}class ht extends st.a{constructor(t,e,n){super(t),this.dueTime=e,this.scheduler=n,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(gt,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:t}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}}clearDebounce(){const t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)}}function gt(t){t.debouncedNext()}var pt=n("AytR");let ft=(()=>{class t{constructor(){this._deviceType$=new R.a(null),this.deviceType$=this._deviceType$.asObservable(),this._mq={sm:null,md:null,lg:null},this._mqParams={sm:null,md:null,lg:null},this._config=pt.a.mediaQueries,this._windowResize$=Object(lt.a)(window,"resize"),this.init(),this._windowResize$.pipe(function(t,e=tt){return n=>n.lift(new dt(t,e))}(800)).subscribe(()=>this.init())}init(){this._deviceTypeParams={deviceType:this.getType(),deviceSize:this.getDeviceSizeData()},this._deviceType$.next(this._deviceTypeParams)}createMq(t){const e=this._config.enable.mqDevice?"device-":"";t.forEach((t,n)=>{this._mq[t[0]]={int:t[1],str:"("+(0===n?"max":"min")+"-"+e+"width: "+t[1]+"px)"}})}getType(){this.createMq(this._config.mqBreakpoints);let t="";return window.matchMedia(this._mq.sm.str).matches&&(t="sm"),window.matchMedia(this._mq.md.str).matches&&(t="md"),window.matchMedia(this._mq.lg.str).matches&&(t="lg"),t}getDeviceSizeData(){this.createMq(this._config.mqBreakpoints);let t="";return Object.keys(this._mq).forEach(e=>{this._mqParams[e]=window.matchMedia(this._mq[e].str).matches,this._mqParams[e]&&(t=e)}),{size:t,mq:this._mqParams,width:window.innerWidth}}getDeviceParams(){return this._deviceTypeParams}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=p["\u0275\u0275defineInjectable"]({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Ct=n("0FX9");const It=["qrcElement"];let _t=(()=>{let t=class{constructor(t,e){this.renderer=t,this.platformId=e,this.colordark="",this.colorlight="",this.level="",this.hidetitle=!1,this.size=0,this.usesvg=!1,this.allowEmptyString=!1,this.qrdata="",this.colorDark="#000000ff",this.colorLight="#ffffffff",this.cssClass="qrcode",this.elementType="canvas",this.errorCorrectionLevel="M",this.margin=4,this.scale=4,this.width=10,this.alt=null,this.ariaLabel=null,this.title=null,this.qrcode=null,this.isValidQrCodeText=t=>!1===this.allowEmptyString?!(void 0===t||""===t||"null"===t||null===t):!(void 0===t),""!==this.colordark&&console.warn("[angularx-qrcode] colordark is deprecated, use colorDark."),""!==this.colorlight&&console.warn("[angularx-qrcode] colorlight is deprecated, use colorLight."),""!==this.level&&console.warn("[angularx-qrcode] level is deprecated, use errorCorrectionLevel."),!1!==this.hidetitle&&console.warn("[angularx-qrcode] hidetitle is deprecated."),0!==this.size&&console.warn("[angularx-qrcode] size is deprecated, use `width`. Defaults to 10."),!1!==this.usesvg&&console.warn("[angularx-qrcode] usesvg is deprecated, use [elementType]=\"'img'\".")}ngAfterViewInit(){Object(r.J)(this.platformId)||this.createQRCode()}ngOnChanges(){this.createQRCode()}toDataURL(){return new Promise((t,e)=>{Object(Ct.toDataURL)(this.qrdata,{color:{dark:this.colorDark,light:this.colorLight},errorCorrectionLevel:this.errorCorrectionLevel,margin:this.margin,scale:this.scale,version:this.version,width:this.width},(n,r)=>{n?e(n):t(r)})})}toCanvas(t){return new Promise((e,n)=>{Object(Ct.toCanvas)(t,this.qrdata,{color:{dark:this.colorDark,light:this.colorLight},errorCorrectionLevel:this.errorCorrectionLevel,margin:this.margin,scale:this.scale,version:this.version,width:this.width},t=>{t?n(t):e("success")})})}toSVG(){return new Promise((t,e)=>{Object(Ct.toString)(this.qrdata,{color:{dark:this.colorDark,light:this.colorLight},errorCorrectionLevel:this.errorCorrectionLevel,margin:this.margin,scale:this.scale,type:"svg",version:this.version,width:this.width},(n,r)=>{n?e(n):t(r)})})}renderElement(t){for(const e of this.qrcElement.nativeElement.childNodes)this.renderer.removeChild(this.qrcElement.nativeElement,e);this.renderer.appendChild(this.qrcElement.nativeElement,t)}createQRCode(){this.version&&this.version>40?(console.warn("[angularx-qrcode] max value for `version` is 40"),this.version=40):this.version&&this.version<1?(console.warn("[angularx-qrcode]`min value for `version` is 1"),this.version=1):void 0!==this.version&&isNaN(this.version)&&(console.warn("[angularx-qrcode] version should be a number, defaulting to auto"),this.version=void 0);try{if(!this.isValidQrCodeText(this.qrdata))throw new Error("[angularx-qrcode] Field `qrdata` is empty");let t;switch(this.elementType){case"canvas":t=this.renderer.createElement("canvas"),this.toCanvas(t).then(()=>{this.ariaLabel&&this.renderer.setAttribute(t,"aria-label",""+this.ariaLabel),this.title&&this.renderer.setAttribute(t,"title",""+this.title),this.renderElement(t)}).catch(t=>{console.error("[angularx-qrcode] canvas error: ",t)});break;case"svg":t=this.renderer.createElement("svg","svg"),this.toSVG().then(e=>{t.innerHTML=e,this.renderer.setAttribute(t,"height",""+this.width),this.renderer.setAttribute(t,"width",""+this.width),this.renderElement(t)}).catch(t=>{console.error("[angularx-qrcode] svg error: ",t)});break;case"url":case"img":default:t=this.renderer.createElement("img"),this.toDataURL().then(e=>{this.alt&&t.setAttribute("alt",this.alt),this.ariaLabel&&t.setAttribute("aria-label",this.ariaLabel),t.setAttribute("src",e),this.title&&t.setAttribute("title",this.title),this.renderElement(t)}).catch(t=>{console.error("[angularx-qrcode] img/url error: ",t)})}}catch(t){console.error("[angularx-qrcode] Error generating QR Code: ",t.message)}}};return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275directiveInject"](p.Renderer2),p["\u0275\u0275directiveInject"](p.PLATFORM_ID))},t.\u0275cmp=p["\u0275\u0275defineComponent"]({type:t,selectors:[["qrcode"]],viewQuery:function(t,e){var n;1&t&&p["\u0275\u0275staticViewQuery"](It,!0),2&t&&p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(e.qrcElement=n.first)},inputs:{colordark:"colordark",colorlight:"colorlight",level:"level",hidetitle:"hidetitle",size:"size",usesvg:"usesvg",allowEmptyString:"allowEmptyString",qrdata:"qrdata",colorDark:"colorDark",colorLight:"colorLight",cssClass:"cssClass",elementType:"elementType",errorCorrectionLevel:"errorCorrectionLevel",margin:"margin",scale:"scale",width:"width",alt:"alt",ariaLabel:"ariaLabel",title:"title",version:"version"},features:[p["\u0275\u0275NgOnChangesFeature"]],decls:2,vars:2,consts:[["qrcElement",""]],template:function(t,e){1&t&&p["\u0275\u0275element"](0,"div",null,0),2&t&&p["\u0275\u0275classMap"](e.cssClass)},encapsulation:2,changeDetection:0}),t})(),mt=(()=>{let t=class{};return t.\u0275mod=p["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},providers:[]}),t})();var Et=n("cq4l");const St=function(t){return{outdated:t}};function vt(t,e){if(1&t&&p["\u0275\u0275element"](0,"qrcode",8),2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275property"]("ngClass",p["\u0275\u0275pureFunction1"](3,St,t.updateState||t.error))("qrdata",t.qrData)("width",160)}}function Ft(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",13),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](2,1,"LOGIN.CODE_OUTDATED")," "))}function Tt(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",14),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](2,1,"LOGIN.CODE_DURATION")," "))}function yt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0,9),p["\u0275\u0275template"](1,Ft,3,3,"div",10),p["\u0275\u0275elementStart"](2,"div",9),p["\u0275\u0275template"](3,Tt,3,3,"div",11),p["\u0275\u0275elementStart"](4,"esia-timer",12),p["\u0275\u0275listener"]("resend",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().updateCode()})),p["\u0275\u0275pipe"](5,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.updateState),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",!t.updateState),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("restartTitle",p["\u0275\u0275pipeBind1"](5,4,"LOGIN.UPDATE"))("timer",t.timer)}}function At(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"div",13),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"button",7),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"]().updateCode()})),p["\u0275\u0275text"](5),p["\u0275\u0275pipe"](6,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}2&t&&(p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](3,2,"LOGIN.QR_ERROR")),p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](6,4,"LOGIN.UPDATE")," "))}let Dt=(()=>{class t extends N.a{constructor(t,e,n){var r,i,o,s,a;super(),this.cdr=t,this.mediaQueriesService=e,this.config=n,this.goBackEvent=new p.EventEmitter,this.updateCodeEvent=new p.EventEmitter,this.params=null===(r=this.config.params)||void 0===r?void 0:r.qr,this.qrSize=140,this.qrUpdateCount=0,this.UPDATE_TIME=1e3*((null===(o=null===(i=this.config.params)||void 0===i?void 0:i.qr)||void 0===o?void 0:o.refreshTime)?null===(a=null===(s=this.config.params)||void 0===s?void 0:s.qr)||void 0===a?void 0:a.refreshTime:60),this.updateState=!1,this.initTimer()}get error(){return"error"===this.qrData}ngOnInit(){this.initSize(),this.error||this.startTimer()}ngOnDestroy(){this.timer.stop()}initSize(){this.mediaQueriesService.deviceType$.pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>{this.qrSize="sm"===t.deviceType?140:160,this.cdr.markForCheck()})}updateCode(){this.updateState=!1,this.updateCodeEvent.emit(),this.startTimer()}initTimer(){this.timer=new ut(this.UPDATE_TIME/1e3,this.cdr),this.timer.timer$.pipe(Object(y.a)(this.unsubscribe),Object(D.a)(t=>0===t)).subscribe(()=>{this.qrUpdateCount++,0!==this.params.refreshCount?(0!==this.qrUpdateCount&&this.qrUpdateCount===this.params.refreshCount?(this.updateState=!0,this.qrUpdateCount=0):this.updateCode(),this.cdr.detectChanges()):this.updateState=!0})}startTimer(){this.timer.start(this.UPDATE_TIME/1e3)}stopTimer(){this.timer.stop()}goBack(){this.timer.stop(),this.goBackEvent.emit()}}return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275directiveInject"](p.ChangeDetectorRef),p["\u0275\u0275directiveInject"](ft),p["\u0275\u0275directiveInject"](C.a))},t.\u0275cmp=p["\u0275\u0275defineComponent"]({type:t,selectors:[["esia-qr-code"]],inputs:{qrData:"qrData"},outputs:{goBackEvent:"goBackEvent",updateCodeEvent:"updateCodeEvent"},features:[p["\u0275\u0275InheritDefinitionFeature"]],decls:12,vars:9,consts:[[1,"text-center","mb-24"],[1,"text-center","mt-24"],[3,"ngClass","qrdata","width",4,"ngIf"],[1,"state-row","flex-container-md","justify-center-md","mt-16"],["class","text-center",4,"ngIf"],[4,"ngIf"],[1,"mt-40","text-center"],["type","button",1,"plain-button-inline",3,"click"],[3,"ngClass","qrdata","width"],[1,"text-center"],["class","text-center red",4,"ngIf"],["class","mb-4",4,"ngIf"],[3,"restartTitle","timer","resend"],[1,"text-center","red"],[1,"mb-4"]],template:function(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",0),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](3,"div",1),p["\u0275\u0275template"](4,vt,1,5,"qrcode",2),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](5,"div",3),p["\u0275\u0275template"](6,yt,6,6,"ng-container",4),p["\u0275\u0275template"](7,At,7,6,"ng-container",5),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](8,"div",6),p["\u0275\u0275elementStart"](9,"button",7),p["\u0275\u0275listener"]("click",(function(){return e.goBack()})),p["\u0275\u0275text"](10),p["\u0275\u0275pipe"](11,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](2,5,"LOGIN.QR_DESCRIPTION")),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",e.qrData),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",!e.error),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",e.error),p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](11,7,"LOGIN.GO_TO_PASSWORD")," "))},directives:[r.t,_t,r.q,Et.a],pipes:[m.d],styles:["qrcode[_ngcontent-%COMP%]{display:block;margin:-5px}.outdated[_ngcontent-%COMP%]{opacity:.1}.state-row[_ngcontent-%COMP%]{text-align:center}@media (max-width:767px){.state-row[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:not(:last-child){margin-bottom:8px}}@media (min-width:768px){.state-row[_ngcontent-%COMP%]{display:flex}.state-row[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:not(:last-child){margin-right:16px}}"],changeDetection:0}),t})();var Ot=n("Iz2d"),Nt=n("Y97i"),wt=n("E6W3"),Rt=n("RdyW");const Pt=function(){return["\u043c\u0438\u043d\u0443\u0442\u0443","\u043c\u0438\u043d\u0443\u0442\u044b","\u043c\u0438\u043d\u0443\u0442"]},bt=function(t){return{time:t}};function xt(t,e){if(1&t&&(p["\u0275\u0275element"](0,"span",6),p["\u0275\u0275pipe"](1,"translate"),p["\u0275\u0275pipe"](2,"pluralize")),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind2"](1,1,t.title,p["\u0275\u0275pureFunction1"](8,bt,t.timeout+"\xa0"+p["\u0275\u0275pipeBind2"](2,4,p["\u0275\u0275pureFunction0"](7,Pt),t.timeout))),p["\u0275\u0275sanitizeHtml"])}}function Lt(t,e){if(1&t&&(p["\u0275\u0275element"](0,"span",6),p["\u0275\u0275pipe"](1,"translate")),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](1,1,t.title),p["\u0275\u0275sanitizeHtml"])}}function Bt(t,e){if(1&t&&(p["\u0275\u0275elementStart"](0,"h3",4),p["\u0275\u0275template"](1,xt,3,10,"span",5),p["\u0275\u0275template"](2,Lt,2,3,"span",5),p["\u0275\u0275elementEnd"]()),2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.isTemporary),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",!t.isTemporary)}}const kt=function(t){return{link:t}};function Mt(t,e){if(1&t&&(p["\u0275\u0275element"](0,"span",6),p["\u0275\u0275pipe"](1,"translate")),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind2"](1,1,t.description,p["\u0275\u0275pureFunction1"](4,kt,t.link)),p["\u0275\u0275sanitizeHtml"])}}function Vt(t,e){if(1&t&&(p["\u0275\u0275element"](0,"span",6),p["\u0275\u0275pipe"](1,"translate")),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](1,1,t.description),p["\u0275\u0275sanitizeHtml"])}}function Gt(t,e){if(1&t&&(p["\u0275\u0275elementStart"](0,"div",7),p["\u0275\u0275template"](1,Mt,2,6,"span",5),p["\u0275\u0275template"](2,Vt,2,3,"span",5),p["\u0275\u0275elementEnd"]()),2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.link),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",!t.link)}}let Ut=(()=>{class t{constructor(t){this.esiaConfig=t}get isTemporary(){return console.log("isTemporary",this.type===o.a.AccountTemporary||this.type===o.a.IpTemporary),this.type===o.a.AccountTemporary||this.type===o.a.IpTemporary}ngOnInit(){switch(this.title=`LOGIN.${this.type}_LOCKED.TITLE`,this.description=`LOGIN.${this.type}_LOCKED.DESCRIPTION`,this.type){case o.a.AccountTemporary:case o.a.AccountPermanent:this.timeout=this.esiaConfig.params.accBlockTimeout?this.esiaConfig.params.accBlockTimeout:15;break;case o.a.IpTemporary:case o.a.IpPermanent:this.timeout=this.esiaConfig.params.ipBlockTimeout?this.esiaConfig.params.ipBlockTimeout:15}}}return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275directiveInject"](C.a))},t.\u0275cmp=p["\u0275\u0275defineComponent"]({type:t,selectors:[["esia-blocking"]],inputs:{type:"type"},decls:4,vars:2,consts:[[1,"blocking"],[1,"blocking_icon","error-sign","exclamation"],["class","blocking_title title-h3 mt-24",4,"ngIf"],["class","blocking_description text-plain mt-24",4,"ngIf"],[1,"blocking_title","title-h3","mt-24"],[3,"innerHTML",4,"ngIf"],[3,"innerHTML"],[1,"blocking_description","text-plain","mt-24"]],template:function(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",0),p["\u0275\u0275element"](1,"div",1),p["\u0275\u0275template"](2,Bt,3,2,"h3",2),p["\u0275\u0275template"](3,Gt,3,2,"div",3),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",e.title),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",e.description))},directives:[r.t],pipes:[m.d,Rt.a],styles:[".blocking_icon[_ngcontent-%COMP%]{display:block;margin:0 auto}.blocking_description[_ngcontent-%COMP%], .blocking_title[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),t})();var Yt=n("qZrB");function qt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"esia-back-button",7),p["\u0275\u0275listener"]("handler",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](2).goBack()})),p["\u0275\u0275elementEnd"]()}}function Ht(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"esia-login-found",23),p["\u0275\u0275listener"]("close",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).changeLogin()})),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](4);p["\u0275\u0275property"]("login",t.login.value)("avatar",t.avatar)}}function jt(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",27),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](2,1,"LOGIN.ERRORS.LOGIN_REQUIRED")," "))}function Kt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",24),p["\u0275\u0275elementStart"](1,"esia-input",25),p["\u0275\u0275listener"]("keyup",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).clearErrors()}))("change",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](4);return e.clearControlValue(e.login)})),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](4,jt,3,3,"div",26),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](4);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("invalid",!t.login.pristine&&t.login.invalid)("name",p["\u0275\u0275pipeBind1"](2,5,"LOGIN.LOGIN"))("labelText",p["\u0275\u0275pipeBind1"](3,7,"LOGIN.LOGIN"))("autocomplete","on"),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",!t.login.pristine&&t.login.getError("required"))}}function zt(t,e){1&t&&(p["\u0275\u0275elementStart"](0,"div",28),p["\u0275\u0275text"](1),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"]()),2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](2,1,"LOGIN.UNEXPECTED.TITLE")," "))}function Qt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",18),p["\u0275\u0275elementStart"](1,"button",29),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).qrInit()})),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](4);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("disabled",t.authActive),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,2,"LOGIN.LOGIN_BUTTON_QR")," ")}}function Xt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",30),p["\u0275\u0275elementStart"](1,"button",16),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](4);return e.changeLoginState(e.loginStates.EdsLogin)})),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}2&t&&(p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,1,"LOGIN.EDS_LINK")," "))}function Wt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"form",10),p["\u0275\u0275template"](2,Ht,1,2,"esia-login-found",11),p["\u0275\u0275template"](3,Kt,5,9,"div",12),p["\u0275\u0275elementStart"](4,"div",13),p["\u0275\u0275elementStart"](5,"esia-input-password",14),p["\u0275\u0275listener"]("keyup",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).clearErrors()}))("change",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](3);return e.clearControlValue(e.password)})),p["\u0275\u0275pipe"](6,"translate"),p["\u0275\u0275pipe"](7,"translate"),p["\u0275\u0275pipe"](8,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](9,"div",15),p["\u0275\u0275elementStart"](10,"button",16),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](3);return e.openLink(e.esiaConfig.links.recovery)})),p["\u0275\u0275text"](11),p["\u0275\u0275pipe"](12,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](13,zt,3,3,"div",17),p["\u0275\u0275elementStart"](14,"div",18),p["\u0275\u0275elementStart"](15,"button",19),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).auth()})),p["\u0275\u0275text"](16),p["\u0275\u0275pipe"](17,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](18,Qt,4,4,"div",20),p["\u0275\u0275template"](19,Xt,4,3,"div",21),p["\u0275\u0275elementStart"](20,"div",22),p["\u0275\u0275elementStart"](21,"button",16),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).openFAQ()})),p["\u0275\u0275text"](22),p["\u0275\u0275pipe"](23,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](3);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("formGroup",t.form),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.loginFound),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",!t.loginFound),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("invalid",!t.password.pristine&&t.password.invalid)("labelText",p["\u0275\u0275pipeBind1"](6,16,"LOGIN.PASSWORD"))("name",p["\u0275\u0275pipeBind1"](7,18,"LOGIN.PASSWORD"))("errorText",p["\u0275\u0275pipeBind1"](8,20,t.passwordErrorText))("commitOnInput",!1)("showRules",!0),p["\u0275\u0275advance"](6),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](12,22,"LOGIN.RECOVERY")," "),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",t.form.getError("unexpected")),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("disabled",t.authActive),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](17,24,"LOGIN.LOGIN_BUTTON")," "),p["\u0275\u0275advance"](2),p["\u0275\u0275property"]("ngIf",t.qrCodeState),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.deviceService.isDesktop()),p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](23,26,"LOGIN.LOGIN_ISSUES")," ")}}function $t(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"esia-qr-code",31),p["\u0275\u0275listener"]("updateCodeEvent",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).qrGetData()}))("goBackEvent",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](3);return e.changeState(e.loginStates.LoginRequired)})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](3);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("qrData",t.qrCodeData)}}function Jt(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"esia-captcha",32),p["\u0275\u0275listener"]("resolve",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).checkCaptcha(e)})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}2&t&&(p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("authType","new"))}const Zt=function(t){return{phone:t}};function te(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"esia-otp",36),p["\u0275\u0275listener"]("otpSuccess",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).otpVerify(e)}))("otpRenew",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).otpRenew()})),p["\u0275\u0275pipe"](1,"translate"),p["\u0275\u0275pipe"](2,"cleanPhoneNumber"),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](4);p["\u0275\u0275property"]("description",p["\u0275\u0275pipeBind2"](1,4,"OTP.DESCRIPTION",p["\u0275\u0275pureFunction1"](9,Zt,p["\u0275\u0275pipeBind1"](2,7,t.mfaDetails.otp.phone))))("otpData",t.mfaDetails.otp)("codeType",t.mfaDetails.otp.otpCodeLength?t.verifyCodeType.Length:t.verifyCodeType.Free)("length",t.mfaDetails.otp.otpCodeLength)}}function ee(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"esia-ttp",37),p["\u0275\u0275listener"]("goBackEvent",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).goBack()}))("checkCode",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).ttpVerify(e)})),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](4);p["\u0275\u0275property"]("state",t.loginState)("errorState",t.errorState)("codeType",t.mfaDetails.ttp.ttpCodeLength?t.verifyCodeType.Length:t.verifyCodeType.Free)("length",t.mfaDetails.ttp.ttpCodeLength)}}function ne(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"esia-ebs",38),p["\u0275\u0275listener"]("eventGoEds",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](4);return e.changeState(e.loginStates.EdsLogin)}))("eventGoBack",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](4);return e.changeState(e.loginStates.LoginRequired)})),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](4);p["\u0275\u0275property"]("expiresAt",t.ebsExpiresAt)("redirectUrl",t.ebsRedirectUrl)("loginState",t.loginState)("errorState",t.errorState)}}function re(t,e){if(1&t&&(p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275template"](1,te,3,11,"esia-otp",33),p["\u0275\u0275template"](2,ee,1,4,"esia-ttp",34),p["\u0275\u0275template"](3,ne,1,4,"esia-ebs",35),p["\u0275\u0275elementContainerEnd"]()),2&t){const t=p["\u0275\u0275nextContext"](3);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.mfaType===t.mfaTypes.Sms||t.otpErrorType),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.mfaType===t.mfaTypes.Ttp||t.ttpErrorType),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.mfaType===t.mfaTypes.Ebs||t.ebsViewState)}}function ie(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"esia-fill-contact",39),p["\u0275\u0275listener"]("sendContact",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).sendContact(e)}))("skipFillContact",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).skipFillContact()})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](3);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("state",t.loginState)("errorState",t.errorState)}}function oe(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"div",30),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](4,"button",40),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).initEdsAuth()})),p["\u0275\u0275text"](5),p["\u0275\u0275pipe"](6,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](7,"div",30),p["\u0275\u0275elementStart"](8,"button",16),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).edsErrorModal()})),p["\u0275\u0275text"](9),p["\u0275\u0275pipe"](10,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementStart"](11,"div",22),p["\u0275\u0275elementStart"](12,"button",16),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](3);return e.changeLoginState(e.loginStates.LoginRequired)})),p["\u0275\u0275text"](13),p["\u0275\u0275pipe"](14,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}2&t&&(p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,4,"LOGIN.INSERT_EDS")," "),p["\u0275\u0275advance"](3),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](6,6,"LOGIN.DONE")," "),p["\u0275\u0275advance"](4),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](10,8,"LOGIN.EDS_ISSUES")," "),p["\u0275\u0275advance"](4),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](14,10,"LOGIN.BACK")," "))}function se(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"esia-grant",41),p["\u0275\u0275listener"]("submitGrants",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](3).submitGrantResult(e)})),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](3);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("grant",t.grantScopesDetails)("errors",t.errorState)}}function ae(t,e){if(1&t&&(p["\u0275\u0275elementContainerStart"](0,8),p["\u0275\u0275template"](1,Wt,24,28,"ng-container",9),p["\u0275\u0275template"](2,$t,2,1,"ng-container",0),p["\u0275\u0275template"](3,Jt,2,1,"ng-container",9),p["\u0275\u0275template"](4,re,4,3,"ng-container",0),p["\u0275\u0275template"](5,ie,2,2,"ng-container",0),p["\u0275\u0275template"](6,oe,15,12,"ng-container",0),p["\u0275\u0275template"](7,se,2,2,"ng-container",0),p["\u0275\u0275elementContainerEnd"]()),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("ngSwitch",t.loginState),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.loginStates.LoginRequired),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.qrCodeViewStates),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.loginStates.UnconditionalCaptcha),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.enterMfaViewStates),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.fillContactViewStates||t.fillContactErrorType),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.loginState===t.loginStates.EdsLogin),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.loginState===t.loginStates.GrantScopeAccess||t.errorState===t.errorStates.ScopesNotAllowed)}}function ce(t,e){if(1&t&&(p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275element"](1,"esia-blocking",42),p["\u0275\u0275elementContainerEnd"]()),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("type",t.blockingState)}}function ue(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275elementStart"](1,"esia-change-password",43),p["\u0275\u0275listener"]("newPassword",(function(e){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](2).changePassword(e)})),p["\u0275\u0275pipe"](2,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("title",p["\u0275\u0275pipeBind1"](2,2,"CHANGE_PASSWORD.TITLE_NEW"))("regexpList",t.passwordPolicies)}}const le=function(){return{icon:"exclamation",title:"LOGIN.EDS_BLOCKED.TITLE",description:"LOGIN.EDS_BLOCKED.DESCRIPTION",link:"/"}};function de(t,e){if(1&t&&p["\u0275\u0275elementContainer"](0,47),2&t){p["\u0275\u0275nextContext"]();const t=p["\u0275\u0275reference"](8);p["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",p["\u0275\u0275pureFunction0"](2,le))}}const he=function(){return{description:"LOGIN.EDS_USER.DESCRIPTION",link:"/",linkText:"LOGIN.EDS_USER.BACK",showFAQ:!0}};function ge(t,e){if(1&t&&p["\u0275\u0275elementContainer"](0,47),2&t){p["\u0275\u0275nextContext"]();const t=p["\u0275\u0275reference"](8);p["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",p["\u0275\u0275pureFunction0"](2,he))}}const pe=function(){return{title:"LOGIN.EDS_DISABLED.TITLE",description:"LOGIN.EDS_DISABLED.DESCRIPTION",goBack:"LOGIN.EDS_DISABLED.BACK",showFAQ:!0}};function fe(t,e){if(1&t&&p["\u0275\u0275elementContainer"](0,47),2&t){p["\u0275\u0275nextContext"]();const t=p["\u0275\u0275reference"](8);p["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",p["\u0275\u0275pureFunction0"](2,pe))}}const Ce=function(){return{title:"LOGIN.EDS_NO_SUBJECT.TITLE",description:"LOGIN.EDS_NO_SUBJECT.DESCRIPTION",goBack:"LOGIN.EDS_NO_SUBJECT.BACK",showFAQ:!0}};function Ie(t,e){if(1&t&&p["\u0275\u0275elementContainer"](0,47),2&t){p["\u0275\u0275nextContext"]();const t=p["\u0275\u0275reference"](8);p["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",p["\u0275\u0275pureFunction0"](2,Ce))}}const _e=function(){return{title:"LOGIN.EDS_UNKNOWN_CERTIFICATE.TITLE",description:"LOGIN.EDS_UNKNOWN_CERTIFICATE.DESCRIPTION",goBack:"LOGIN.EDS_UNKNOWN_CERTIFICATE.BACK",showFAQ:!0}};function me(t,e){if(1&t&&p["\u0275\u0275elementContainer"](0,47),2&t){p["\u0275\u0275nextContext"]();const t=p["\u0275\u0275reference"](8);p["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",p["\u0275\u0275pureFunction0"](2,_e))}}const Ee=function(){return{description:"IDP.EDS_INVALID.TITLE",goBack:"IDP.EDS_INVALID.BACK",showFAQ:!0}};function Se(t,e){if(1&t&&p["\u0275\u0275elementContainer"](0,47),2&t){p["\u0275\u0275nextContext"]();const t=p["\u0275\u0275reference"](8);p["\u0275\u0275property"]("ngTemplateOutlet",t)("ngTemplateOutletContext",p["\u0275\u0275pureFunction0"](2,Ee))}}function ve(t,e){if(1&t&&p["\u0275\u0275element"](0,"div"),2&t){const t=p["\u0275\u0275nextContext"]().icon;p["\u0275\u0275classMapInterpolate1"]("error-sign ",t," mb-24")}}function Fe(t,e){if(1&t&&(p["\u0275\u0275element"](0,"div",53),p["\u0275\u0275pipe"](1,"translate")),2&t){const t=p["\u0275\u0275nextContext"]().title;p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind1"](1,1,t),p["\u0275\u0275sanitizeHtml"])}}const Te=function(t){return{link:t}};function ye(t,e){if(1&t&&(p["\u0275\u0275element"](0,"div",54),p["\u0275\u0275pipe"](1,"translate")),2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275property"]("innerHTML",p["\u0275\u0275pipeBind2"](1,1,t.description,p["\u0275\u0275pureFunction1"](4,Te,t.link)),p["\u0275\u0275sanitizeHtml"])}}function Ae(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",55),p["\u0275\u0275elementStart"](1,"button",56),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).goBack()})),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}if(2&t){const t=p["\u0275\u0275nextContext"]().goBack;p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,1,t)," ")}}function De(t,e){if(1&t&&(p["\u0275\u0275elementStart"](0,"div",55),p["\u0275\u0275elementStart"](1,"a",57),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()),2&t){const t=p["\u0275\u0275nextContext"](),e=t.link,n=t.linkText;p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("href",e,p["\u0275\u0275sanitizeUrl"]),p["\u0275\u0275advance"](1),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,2,n)," ")}}function Oe(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",58),p["\u0275\u0275elementStart"](1,"a",59),p["\u0275\u0275listener"]("click",(function(){return p["\u0275\u0275restoreView"](t),p["\u0275\u0275nextContext"](4).openFAQ()})),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}2&t&&(p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate"](p["\u0275\u0275pipeBind1"](3,1,"LOGIN.LOGIN_ISSUES")))}function Ne(t,e){if(1&t&&(p["\u0275\u0275template"](0,ve,1,3,"div",48),p["\u0275\u0275template"](1,Fe,2,3,"div",49),p["\u0275\u0275template"](2,ye,2,6,"div",50),p["\u0275\u0275template"](3,Ae,4,3,"div",51),p["\u0275\u0275template"](4,De,4,4,"div",51),p["\u0275\u0275template"](5,Oe,4,3,"div",52)),2&t){const t=e.title,n=e.description,r=e.goBack,i=e.linkText,o=e.showFAQ;p["\u0275\u0275property"]("ngIf",e.icon),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",n),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",r),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",i),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",o)}}function we(t,e){if(1&t&&(p["\u0275\u0275elementStart"](0,"div",44),p["\u0275\u0275template"](1,de,1,3,"ng-container",45),p["\u0275\u0275template"](2,ge,1,3,"ng-container",45),p["\u0275\u0275template"](3,fe,1,3,"ng-container",45),p["\u0275\u0275template"](4,Ie,1,3,"ng-container",45),p["\u0275\u0275template"](5,me,1,3,"ng-container",45),p["\u0275\u0275template"](6,Se,1,3,"ng-container",45),p["\u0275\u0275template"](7,Ne,6,6,"ng-template",null,46,p["\u0275\u0275templateRefExtractor"]),p["\u0275\u0275elementEnd"]()),2&t){const t=p["\u0275\u0275nextContext"](2);p["\u0275\u0275property"]("ngSwitch",t.errorState),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.errorStates.EdsBlocked),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.errorStates.EdsCertificateUserNotMatch),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.errorStates.EdsUnavailable),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.errorStates.EdsNoSubjectFound),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.errorStates.EdsUnknownCertificate),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngSwitchCase",t.errorStates.EdsInvalid)}}function Re(t,e){if(1&t){const t=p["\u0275\u0275getCurrentView"]();p["\u0275\u0275elementStart"](0,"div",60),p["\u0275\u0275elementStart"](1,"button",16),p["\u0275\u0275listener"]("click",(function(){p["\u0275\u0275restoreView"](t);const e=p["\u0275\u0275nextContext"](2);return e.openLink(e.esiaConfig.links.registration)})),p["\u0275\u0275text"](2),p["\u0275\u0275pipe"](3,"translate"),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementEnd"]()}2&t&&(p["\u0275\u0275advance"](2),p["\u0275\u0275textInterpolate1"](" ",p["\u0275\u0275pipeBind1"](3,1,"LOGIN.REGISTER")," "))}function Pe(t,e){if(1&t&&(p["\u0275\u0275elementContainerStart"](0),p["\u0275\u0275element"](1,"esia-disclaimers"),p["\u0275\u0275elementStart"](2,"div",1),p["\u0275\u0275elementStart"](3,"div",2),p["\u0275\u0275pipe"](4,"async"),p["\u0275\u0275element"](5,"esia-header"),p["\u0275\u0275template"](6,qt,1,0,"esia-back-button",3),p["\u0275\u0275template"](7,ae,8,8,"ng-container",4),p["\u0275\u0275template"](8,ce,2,1,"ng-container",0),p["\u0275\u0275template"](9,ue,3,4,"ng-container",0),p["\u0275\u0275template"](10,we,9,7,"div",5),p["\u0275\u0275elementEnd"](),p["\u0275\u0275template"](11,Re,4,3,"div",6),p["\u0275\u0275elementEnd"](),p["\u0275\u0275elementContainerEnd"]()),2&t){const t=p["\u0275\u0275nextContext"]();p["\u0275\u0275advance"](3),p["\u0275\u0275classProp"]("form-container_load",t.load||!p["\u0275\u0275pipeBind1"](4,8,t.loadTranslate$)),p["\u0275\u0275advance"](3),p["\u0275\u0275property"]("ngIf",t.backButtonViewState),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",!t.blockingViewStates),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.blockingViewStates),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.changePasswordViewStates),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.edsErrorsStates),p["\u0275\u0275advance"](1),p["\u0275\u0275property"]("ngIf",t.registrationActionViewState)}}const be=[{path:"",component:(()=>{class t extends N.a{constructor(t,e,n,r,i,s,a,c,u,l,d,h,g,p){var f;super(),this.activatedRoute=t,this.detectLogin=e,this.modalService=n,this.router=r,this.validationService=i,this.configService=s,this.authService=a,this.passwordService=c,this.changeDetector=u,this.reactionService=l,this.ifcService=d,this.cookieService=h,this.deviceService=g,this.translate=p,this.esiaConfig=this.configService.params,this.endpoint="aas/oauth2/api",this.load=!1,this.loadTranslate$=new R.a(!1),this.logged=!1,this.routerLoginState=null===(f=this.activatedRoute.snapshot.queryParams)||void 0===f?void 0:f.loginState,this.routerLoginStateData=this.router.getCurrentNavigation().extras.state,this.loginState=o.d.LoginRequired,this.loginFound=!1,this.authActive=!1,this.initLoginForm()}get loginStates(){return o.d}get errorStates(){return o.b}get blockingStates(){return o.a}get mfaTypes(){return o.c}get blockingViewStates(){return Object.values(this.blockingStates).includes(this.blockingState)}get fillContactViewStates(){return this.loginState===this.loginStates.FillEmail||this.loginState===this.loginStates.FillPhone}get changePasswordViewStates(){return this.loginState===this.loginStates.ChangePassword||this.errorState===this.errorStates.BadNewPassword}get qrCodeViewStates(){return this.loginState===this.loginStates.QrCode}get enterMfaViewStates(){return this.loginState===this.loginStates.EnterMfa||this.otpErrorType||this.ttpErrorType||this.ebsErrorType}get backButtonViewState(){return this.loginState===this.loginStates.EnterMfa||this.loginState===this.loginStates.QrCode}get registrationActionViewState(){return this.loginState===this.loginStates.LoginRequired||this.loginState===this.loginStates.EdsLogin}get verifyCodeType(){return g.b}get login(){return this.form.get("login")}get password(){return this.form.get("password")}get passwordErrorText(){return this.password.pristine?"":this.password.getError("emptyFields")?"IDP.ERRORS.EMPTY_FIELDS":this.password.getError("required")?"IDP.ERRORS.PASSWORD_REQUIRED":this.password.getError("wrong")?"IDP.ERRORS.WRONG_PASSWORD":void 0}ebsViewState(){return this.ebsErrorType||Boolean(this.ebsExpiresAt)}get edsErrorsStates(){return[this.errorStates.EdsInvalid,this.errorStates.EdsBlocked,this.errorStates.EdsUnavailable,this.errorStates.EdsCertificateUserNotMatch,this.errorStates.EdsUnknownCertificate,this.errorStates.EdsNoSubjectFound,this.errorStates.EdsNonlegal].includes(this.errorState)}get errorViewStates(){return Object.values(this.errorStates).includes(this.errorState)}get ebsErrorType(){return this.errorState===this.errorStates.EbsInvalid||this.errorState===this.errorStates.EbsOutdated||this.errorState===this.errorStates.EbsDeviceInvalid||this.errorState===this.errorStates.EbsExpired}get otpErrorType(){return this.errorState===this.errorStates.WrongOtp}get ttpErrorType(){return this.errorState===this.errorStates.WrongTtp}get fillContactErrorType(){return[this.errorStates.OidNull,this.errorStates.MobileBlank,this.errorStates.StringNotMobile,this.errorStates.MobileBusy,this.errorStates.AddMobileError,this.errorStates.EmailBlank,this.errorStates.StringNotEmail,this.errorStates.EmailBusy,this.errorStates.AddEmailError].includes(this.errorState)}ngOnInit(){this.initState(),this.translate.get("LOGIN").pipe(Object(y.a)(this.unsubscribe)).subscribe(()=>{this.loadTranslate$.next(!0)})}initState(){var t;if("next-step"===this.activatedRoute.snapshot.queryParams.do&&(this.router.navigate([]).then(),this.load=!0,this.authService.nextStep$().pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>{this.load=!1,this.authProcessing(t)})),this.routerLoginState)if(this.router.navigate([]).then(),"authProcessing"!==this.routerLoginState)switch(this.routerLoginState.toUpperCase()){case this.loginStates.EdsLogin:this.changeLoginState(this.loginStates.EdsLogin);break;case this.loginStates.QrCode:this.qrCodeState=!0}else this.authProcessing(this.routerLoginStateData);else this.checkLoginFound(),this.changeLoginState(this.loginStates.LoginRequired);this.activatedRoute.queryParams.pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>{this.logged=void 0!==(null==t?void 0:t.logged),(null==this?void 0:this.logged)&&this.auth()}),this.qrCodeState=(null===(t=this.esiaConfig.qr)||void 0===t?void 0:t.login)&&!this.deviceService.isMobile()}initLoginForm(){this.form=new s.FormGroup({login:new s.FormControl("",[s.Validators.required]),password:new s.FormControl("",[s.Validators.required])})}checkLoginFound(){if(this.detectLogin.check()){const t=this.detectLogin.login;this.loginFound=!0,this.login.setValue(t),this.detectLogin.avatar$.pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>{this.avatar=t,this.changeDetector.detectChanges()})}}auth(){this.userLogin=this.logged?{login:null,idType:null}:this.validationService.formatLogin(this.login),this.logged||(!this.form.invalid||this.userLogin)&&this.password.value?(this.authActive=!0,this.authService.auth$(this.endpoint,{login:this.login.value,password:this.password.value}).pipe(Object(y.a)(this.unsubscribe),Object(A.a)(()=>{this.cookieService.delete("loginType")})).subscribe(t=>this.authProcessing(t))):(this.login.markAsDirty(),this.password.markAsDirty(),this.password.value||this.password.setErrors({required:!0}),this.login.value||this.password.value||(this.login.setErrors({}),this.password.setErrors({emptyFields:!0})))}qrInit(){this.load=!0,this.qrGetData(),this.authService.qrAuthData$.pipe(Object(y.a)(this.unsubscribe),Object(D.a)(t=>null!==t)).subscribe(t=>{if(t.login){const t=new Date;this.cookieService.set("loginType","qrCode",t.getMonth()+6)}this.authProcessing(t),this.changeDetector.detectChanges()})}qrGetData(){this.authService.generateQrCode().pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>{this.load=!1,this.qrAuthStart(t)},()=>{this.changeState(this.loginStates.QrCode),this.qrCodeData="error"})}qrAuthStart(t){this.changeState(o.d.QrCode),this.load=!1,this.qrCodeData=`mpgosuslugi://${t.type||"auth"}/signed_token=${t.signed_token}&url=${t.url}};`,this.authService.createEventSource(t.qr_id).pipe(Object(O.a)(1),Object(y.a)(this.unsubscribe)).subscribe(),this.errorState=void 0,this.changeDetector.detectChanges()}changePassword(t){this.authService.changePassword$(this.endpoint,t).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}otpVerify(t){this.authService.otpVerify$(""+this.endpoint,t).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}otpRenew(){this.authService.otpRenew$(""+this.endpoint).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}ttpVerify(t){this.authService.ttpVerify$(""+this.endpoint,t).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}sendContact(t){this.authService.sendContact$(""+this.endpoint,t).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}skipFillContact(){this.authService.skipFillContact$(""+this.endpoint).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}initEdsAuth(){this.ifcService.checkPlugin().then(()=>{this.authService.edsDigitalRequest$(""+this.endpoint).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>{this.ifcService.sign(t.digital_challenge).then(t=>{this.edsAuth(t)})})})}edsAuth(t){this.authService.edsAuth$(this.endpoint,t).pipe(Object(y.a)(this.unsubscribe),Object(A.a)(t=>{t.login!==this.loginStates.Done&&this.modalService.destroyForm()})).subscribe(t=>this.authProcessing(t))}checkCaptcha(t){this.authService.checkCaptcha$((t.endpoint?t.endpoint:this.endpoint)||this.endpoint,t.token).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}submitGrantResult(t){this.authService.grantRequest$(this.endpoint,t).pipe(Object(y.a)(this.unsubscribe)).subscribe(t=>this.authProcessing(t))}authProcessing(t){switch(this.ebsExpiresAt=void 0,this.ebsRedirectUrl=void 0,this.loginState=t.login,this.errorState=t.error,this.blockingState=t.blocking,this.changeDetector.markForCheck(),t.login){case this.loginStates.Done:this.openLink(t.redirectUrl);break;case this.loginStates.GrantScopeAccess:this.grantScopesDetails=t.grantScopesDetails;break;case this.loginStates.GrantPermissionAccess:this.router.navigate(["grant-permission-access"],{state:{permissionList:t.permissionList},relativeTo:this.activatedRoute}).then();break;case this.loginStates.SolveAnomalyReaction:this.reactionService.checkResponse({anomaly_reaction:{anomaly_reaction:t.reactionDetails.type,guid:t.reactionDetails.guid}},{version:2,successCallback:t=>this.authProcessing(new h.a(t)),errorCallback:t=>this.authProcessing(new h.a(t))});break;case this.loginStates.ChangePassword:this.passwordPolicies=t.passwordPolicies;break;case this.loginStates.EnterMfa:this.mfaType=t.mfaType,this.initMfaAction(t);break;case this.loginStates.AskDigitalOffer:this.router.navigate(["ask-digital-offer"],{state:{digitalOfferOrganizationList:t.digitalOfferOrganizationList},relativeTo:this.activatedRoute}).then()}switch(t.error){case this.errorStates.BadNewPassword:this.loginState=this.loginStates.ChangePassword,this.changeDetector.detectChanges(),this.changePasswordComponent.error="LOGIN.ERRORS.NEW_PASSWORD";break;case this.errorStates.WrongPassword:this.loginState=this.loginStates.LoginRequired,this.changeDetector.detectChanges(),this.password.setErrors({wrong:!0}),this.login.setErrors({invalid:!0});break;case this.errorStates.CaptchaInvalid:this.loginState=this.loginStates.UnconditionalCaptcha,this.changeDetector.detectChanges(),this.captcha.setInvalid();break;case this.errorStates.WrongOtp:this.otp.setInvalid();break;case this.errorStates.WrongTtp:this.ttp.setError(this.errorStates.WrongTtp);break;case this.errorStates.QrCodeEventSourceOutdated:this.changeState(this.loginStates.QrCode)}this.edsErrorsStates&&this.modalService.destroyForm(),this.authActive=!1,this.changeDetector.detectChanges()}initMfaAction(t){switch(this.mfaDetails=t.mfaDetails,this.mfaType){case this.mfaTypes.Sms:this.otp&&(this.otp.restartTimer(this.mfaDetails.otp),this.errorState===this.errorStates.WrongOtp&&this.otp.setInvalid());break;case this.mfaTypes.Ebs:const e=this.deviceService.getDeviceInfo().os,n=Boolean(this.cookieService.get("can_bio"));e===w.Windows||e===w.Mac||e===w.Linux||n?t.mfaDetails.ebs.expireTime?(this.ebsExpiresAt=t.mfaDetails.ebs.expireTime,this.ebsRedirectUrl=t.mfaDetails.ebs.redirectUrl):this.openLink(t.redirectUrl):this.errorState=this.errorStates.EbsDeviceInvalid}}clearErrors(){this.login.value&&this.login.setErrors(null),this.password.setErrors(null)}clearControlValue(t){this.validationService.controlTrim(t)}changeLoginState(t){this.loginState=t}changeLogin(){this.loginFound=!1,this.login.setValue(""),this.login.markAsPristine()}openFAQ(){this.modalService.popupInject(a.a,null)}edsErrorModal(){this.modalService.popupInject(l.a,null,{type:"issues"})}changeState(t){this.errorState=null,this.loginState=t}goBack(){switch(this.loginState){case this.loginStates.EnterMfa:case this.loginStates.QrCode:this.qrCodeData=void 0,this.changeState(this.loginStates.LoginRequired);break;default:this.changeState(this.loginStates.LoginRequired)}this.changeDetector.detectChanges()}openLink(t){this.modalService.destroyForm(),this.load=!0,window.location.href=t||"/"}}return t.\u0275fac=function(e){return new(e||t)(p["\u0275\u0275directiveInject"](i.a),p["\u0275\u0275directiveInject"](P.a),p["\u0275\u0275directiveInject"](b.a),p["\u0275\u0275directiveInject"](i.c),p["\u0275\u0275directiveInject"](x.a),p["\u0275\u0275directiveInject"](C.a),p["\u0275\u0275directiveInject"](L.a),p["\u0275\u0275directiveInject"](B.a),p["\u0275\u0275directiveInject"](p.ChangeDetectorRef),p["\u0275\u0275directiveInject"](k.a),p["\u0275\u0275directiveInject"](H),p["\u0275\u0275directiveInject"](j.a),p["\u0275\u0275directiveInject"](K.a),p["\u0275\u0275directiveInject"](m.e))},t.\u0275cmp=p["\u0275\u0275defineComponent"]({type:t,selectors:[["esia-login"]],viewQuery:function(t,e){var n;1&t&&(p["\u0275\u0275viewQuery"](c.a,!0),p["\u0275\u0275viewQuery"](T,!0),p["\u0275\u0275viewQuery"](d.a,!0),p["\u0275\u0275viewQuery"](u.a,!0)),2&t&&(p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(e.otp=n.first),p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(e.ttp=n.first),p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(e.captcha=n.first),p["\u0275\u0275queryRefresh"](n=p["\u0275\u0275loadQuery"]())&&(e.changePasswordComponent=n.first))},features:[p["\u0275\u0275InheritDefinitionFeature"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"container"],[1,"form-container"],[3,"handler",4,"ngIf"],[3,"ngSwitch",4,"ngIf"],["class","text-center",3,"ngSwitch",4,"ngIf"],["class","text-center mt-20 mt-md-40 mb-md-40",4,"ngIf"],[3,"handler"],[3,"ngSwitch"],[4,"ngSwitchCase"],[3,"formGroup"],[3,"login","avatar","close",4,"ngIf"],["class","input-control mb-20",4,"ngIf"],[1,"input-control","mb-8"],["id","password","formControlName","password",3,"invalid","labelText","name","errorText","commitOnInput","showRules","keyup","change"],[1,"flex-container","justify-between","mb-40"],["type","button",1,"plain-button-inline",3,"click"],["class","error-label mb-32",4,"ngIf"],[1,"mb-24"],[1,"plain-button","plain-button_wide",3,"disabled","click"],["class","mb-24",4,"ngIf"],["class","text-center mb-40",4,"ngIf"],[1,"text-center"],[3,"login","avatar","close"],[1,"input-control","mb-20"],["id","login","formControlName","login",3,"invalid","name","labelText","autocomplete","keyup","change"],["class","error-label",4,"ngIf"],[1,"error-label"],[1,"error-label","mb-32"],[1,"plain-button","plain-button_wide","plain-button_white","plain-button_qr",3,"disabled","click"],[1,"text-center","mb-40"],[3,"qrData","updateCodeEvent","goBackEvent"],[3,"authType","resolve"],[3,"description","otpData","codeType","length","otpSuccess","otpRenew",4,"ngIf"],[3,"state","errorState","codeType","length","goBackEvent","checkCode",4,"ngIf"],[3,"expiresAt","redirectUrl","loginState","errorState","eventGoEds","eventGoBack",4,"ngIf"],[3,"description","otpData","codeType","length","otpSuccess","otpRenew"],[3,"state","errorState","codeType","length","goBackEvent","checkCode"],[3,"expiresAt","redirectUrl","loginState","errorState","eventGoEds","eventGoBack"],[3,"state","errorState","sendContact","skipFillContact"],[1,"plain-button","plain-button_wide","mb-32",3,"click"],[3,"grant","errors","submitGrants"],[3,"type"],[3,"title","regexpList","newPassword"],[1,"text-center",3,"ngSwitch"],[3,"ngTemplateOutlet","ngTemplateOutletContext",4,"ngSwitchCase"],["edsErrorTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"class",4,"ngIf"],["class","title-h3 mb-24",3,"innerHTML",4,"ngIf"],["class","text-plain",3,"innerHTML",4,"ngIf"],["class","button-wrapper mt-40",4,"ngIf"],["class","mt-40",4,"ngIf"],[1,"title-h3","mb-24",3,"innerHTML"],[1,"text-plain",3,"innerHTML"],[1,"button-wrapper","mt-40"],[1,"plain-button","plain-button_wide",3,"click"],[1,"plain-button","plain-button_wide",3,"href"],[1,"mt-40"],[3,"click"],[1,"text-center","mt-20","mt-md-40","mb-md-40"]],template:function(t,e){1&t&&p["\u0275\u0275template"](0,Pe,12,10,"ng-container",0),2&t&&p["\u0275\u0275property"]("ngIf",!e.logged)},directives:[r.t,z.a,Q.a,I.a,r.x,r.y,s["\u0275angular_packages_forms_forms_y"],s.NgControlStatusGroup,s.FormGroupDirective,X.a,s.NgControlStatus,s.FormControlName,W.a,_.a,Dt,d.a,c.a,T,Ot.a,Nt.a,wt.a,Ut,u.a,r.A],pipes:[r.b,m.d,Yt.a],styles:[""],changeDetection:0}),t})()},{path:"grant-permission-access",loadChildren:()=>n.e(9).then(n.bind(null,"KEJ5")).then(t=>t.GrantPermissionAccessModule)},{path:"ask-digital-offer",loadChildren:()=>n.e(7).then(n.bind(null,"azB5")).then(t=>t.AskDigitalOfferModule)}];let xe=(()=>{class t{}return t.\u0275mod=p["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[i.g.forChild(be)],i.g]}),t})();var Le=n("tk/3"),Be=n("FpXt"),ke=n("mEFa");let Me=(()=>{class t{}return t.\u0275mod=p["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[r.c,m.c,ke.a,s.ReactiveFormsModule,Be.a]]}),t})();var Ve=n("ixO3");let Ge=(()=>{class t{}return t.\u0275mod=p["\u0275\u0275defineNgModule"]({type:t}),t.\u0275inj=p["\u0275\u0275defineInjector"]({factory:function(e){return new(e||t)},imports:[[r.c,s.FormsModule,s.ReactiveFormsModule,m.c,Le.c,Be.a,xe,Ve.a,ke.a,Me,mt]]}),t})()},J6Nv:function(t,e){e.isValid=function(t){return!isNaN(t)&&t>=1&&t<=40}},JzKC:function(t,e,n){var r=n("Wogr"),i=n("aZ40");e.mul=function(t,e){var n=new r(t.length+e.length-1);n.fill(0);for(var o=0;o<t.length;o++)for(var s=0;s<e.length;s++)n[o+s]^=i.mul(t[o],e[s]);return n},e.mod=function(t,e){for(var n=new r(t);n.length-e.length>=0;){for(var o=n[0],s=0;s<e.length;s++)n[s]^=i.mul(e[s],o);for(var a=0;a<n.length&&0===n[a];)a++;n=n.slice(a)}return n},e.generateECPolynomial=function(t){for(var n=new r([1]),o=0;o<t;o++)n=e.mul(n,[1,i.exp(o)]);return n}},Lzq4:function(t,e,n){var r=n("u/Db"),i=n("e/Dd");function o(t){this.mode=r.KANJI,this.data=t}o.getBitsLength=function(t){return 13*t},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(t){var e;for(e=0;e<this.data.length;e++){var n=i.toSJIS(this.data[e]);if(n>=33088&&n<=40956)n-=33088;else{if(!(n>=57408&&n<=60351))throw new Error("Invalid SJIS character: "+this.data[e]+"\nMake sure your charset is UTF-8");n-=49472}t.put(n=192*(n>>>8&255)+(255&n),13)}},t.exports=o},NPxG:function(t,e,n){var r=n("ekOh"),i=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],o=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];e.getBlocksCount=function(t,e){switch(e){case r.L:return i[4*(t-1)+0];case r.M:return i[4*(t-1)+1];case r.Q:return i[4*(t-1)+2];case r.H:return i[4*(t-1)+3];default:return}},e.getTotalCodewordsCount=function(t,e){switch(e){case r.L:return o[4*(t-1)+0];case r.M:return o[4*(t-1)+1];case r.Q:return o[4*(t-1)+2];case r.H:return o[4*(t-1)+3];default:return}}},PhFw:function(t,e){!function(t){t.IFCCrypto=function(t){this.getAlias=function(){return IFCConst.emptyString(t.alias)},this.getName=function(){return IFCConst.emptyString(t.name)},this.isPKCS11=function(){return t.type===IFCConst.IFC_CRYPTO_PKCS11},this.isCAPI=function(){return t.type===IFCConst.IFC_CRYPTO_CAPI},this.isCAPI_LINUX=function(){return t.type===IFCConst.IFC_CRYPTO_CAPI_LINUX},this.getPath=function(){return IFCConst.emptyString(t.path)},this.getNumber=function(){return IFCConst.emptyString(t.num)},this.getDescription=function(){return IFCConst.emptyString(t.description)},this.getSerialNumber=function(){return IFCConst.emptyString(t.serial_number)},this.getModel=function(){return IFCConst.emptyString(t.model)},this.getSkipPKCS11List=function(){return IFCConst.emptyString(t.skip_pkcs11_list)},this.getAlg=function(){return IFCConst.emptyString(t.alg)},this.getCryptoId=function(){return t.type===IFCConst.IFC_CRYPTO_PKCS11?t.crypto_id=t.alias+"/"+t.num:t.type!==IFCConst.IFC_CRYPTO_CAPI&&t.type!==IFCConst.IFC_CRYPTO_CAPI_LINUX||(t.crypto_id=t.alias),IFCConst.emptyString(t.crypto_id)},this.getExtendedKeyUsage=function(){for(var t=this.getAlias(),e=[{alias:"JaCarta",oid:"1.2.643.3.205.110.1"},{alias:"ruTokenECP",oid:"1.2.643.3.205.110.7"},{alias:"VIPNet",oid:"1.2.643.3.205.110.6"},{alias:"SignalCom",oid:"1.2.643.3.205.110.8"},{alias:"LISSI-CSP",oid:"1.2.643.3.205.110.9"},{alias:"CryptoPro",oid:"1.2.643.3.205.110.2"}],n=0;n<e.length;n++)if(t.indexOf(e[n].alias)>=0)return e[n].oid;return""},this.getCertificatePolicies=function(){for(var t=this.getAlias(),e=[{alias:"JaCarta",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"ruTokenECP",oid:IFCConst.OID_KC1+","+IFCConst.OID_KC2},{alias:"CryptoPro",oid:IFCConst.OID_KC1},{alias:"VIPNet",oid:IFCConst.OID_KC1},{alias:"SignalCom",oid:IFCConst.OID_KC1},{alias:"LISSI-CSP",oid:IFCConst.OID_KC1}],n=0;n<e.length;n++)if(t.indexOf(e[n].alias)>=0)return e[n].oid;return IFCConst.OID_KC1}},t.IFCCertificate=function(t,e){this.getSerialNumber=function(){return IFCConst.emptyString(t.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2012_256||t===IFCConst.OID_GOSTR3410_2012_512||t===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2001?"gost_2001":t===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":t===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(t.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getId=function(){return IFCConst.emptyString(t.id)},this.getContainerId=function(){return e.getCryptoId()+"/"+IFCConst.emptyString(t.id)},this.getCryptoId=function(){return e.getCryptoId()},this.isPKCS11=function(){return e.isPKCS11()},this.isCAPI=function(){return e.isCAPI()},this.isCAPI_LINUX=function(){return e.isCAPI_LINUX()},this.checkDate=function(t){return isNaN(new Date(t).getTime())?t.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):t}},t.IFCCertificateInfo=function(t){this.getSerialNumber=function(){return IFCConst.emptyString(t.cert_sn)},this.getSubjectDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_subject),IFCConst.DN_SEPARATOR_PLUGIN)},this.getIssuerDN=function(){return new IFCDN(IFCConst.emptyString(t.cert_issuer),IFCConst.DN_SEPARATOR_PLUGIN)},this.getValidFrom=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_from))},this.getValidTo=function(){return IFCConst.emptyString(this.checkDate(t.cert_valid_to))},this.getSignAndDigestAlgUri=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2012_256||t===IFCConst.OID_GOSTR3410_2012_512||t===IFCConst.OID_GOSTR3410_2001?{signMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr34102001-gostr3411",digestMethod:"http://www.w3.org/2001/04/xmldsig-more#gostr3411"}:{signMethod:"",digestMethod:""}},this.getSignAlg=function(){var t=this.getSignAlgOid();return t===IFCConst.OID_GOSTR3410_2001?"gost_2001":t===IFCConst.OID_GOSTR3410_2012_256?"gost_2012_256":t===IFCConst.OID_GOSTR3410_2012_512?"gost_2012_512":""},this.getSignAlgOid=function(){return IFCConst.emptyString(t.cert_sign_alg)},this.isValid=function(){return new Date<new Date(this.getValidTo())},this.getBase64=function(){return IFCConst.emptyString(t.base64)},this.getPem=function(){return IFCConst.emptyString(t.pem)},this.getVersion=function(){return IFCConst.emptyString(t.version)},this.getExtensionsString=function(){return IFCConst.emptyString(t.extensions)},this.getPrintableText=function(){return this.getPrintable("\n","\t",", ")},this.getPrintableHTML=function(){return this.getPrintable("<br />","&nbsp;&nbsp;",", ")},this.getPrintable=function(t,e,n){t||(t="\n"),e||(e="\t"),n||(n=", ");var r="\u041d\u043e\u043c\u0435\u0440 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430: "+this.getSerialNumber()+t+"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430:"+t+e+e+"\u0441 "+this.getValidFrom()+t+e+e+"\u043f\u043e "+this.getValidTo()+t+t+e+"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e \u0432\u043b\u0430\u0434\u0435\u043b\u044c\u0446\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430"+t+t+"\u0424\u0430\u043c\u0438\u043b\u0438\u044f, \u0438\u043c\u044f, \u043e\u0442\u0447\u0435\u0441\u0442\u0432\u043e: "+this.getSubjectDN().getCommonName()+t+"\u0421\u0442\u0440\u0430\u0445\u043e\u0432\u043e\u0439 \u043d\u043e\u043c\u0435\u0440 \u0438\u043d\u0434\u0438\u0432\u0438\u0434\u0443\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u043b\u0438\u0446\u0435\u0432\u043e\u0433\u043e \u0441\u0447\u0435\u0442\u0430: "+this.getSubjectDN().getSNILS()+t+t+e+"\u0421\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u043e\u0431 \u0438\u0437\u0434\u0430\u0442\u0435\u043b\u0435 \u043a\u0432\u0430\u043b\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u043d\u043e\u0433\u043e \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430"+t+t+"\u041d\u0430\u0438\u043c\u0435\u043d\u043e\u0432\u0430\u043d\u0438\u0435  \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e  \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getCommonName()+t+"\u041c\u0435\u0441\u0442\u043e  \u043d\u0430\u0445\u043e\u0436\u0434\u0435\u043d\u0438\u044f  \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getCountryName()+n+this.getIssuerDN().getStateOrProvinceName()+n+this.getIssuerDN().getLocalityName()+n+this.getIssuerDN().getStreetAddress()+t;return this.getIssuerDN().getSurname()?r+="\u0414\u043e\u0432\u0435\u0440\u0435\u043d\u043d\u043e\u0435 \u043b\u0438\u0446\u043e \u0443\u0434\u043e\u0441\u0442\u043e\u0432\u0435\u0440\u044f\u044e\u0449\u0435\u0433\u043e \u0446\u0435\u043d\u0442\u0440\u0430: "+this.getIssuerDN().getSurname():this.getIssuerDN().getGivenName()?r+=n+this.getIssuerDN().getGivenName()+t:r+=t,r+(e+"\u0420\u0430\u0441\u0448\u0438\u0440\u0435\u043d\u0438\u044f \u0441\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442\u0430")+t+t+this.getExtensionsString().replace(/(\r\n|\n|\r)/gm,t).replace(/^\s+/gm,e)},this.checkDate=function(t){return isNaN(new Date(t).getTime())?t.replace(/([a-z]*\s\d{1,2}\s)((?:\d{2}:?){3})\s(\d{4}\s)(.*)/i,"$1$3$2$4"):t}},t.IFCDN=function(t,e){var n=function(t){switch(t.toLowerCase()){case"commonname":case"cn":return IFCConst.OID_COMMON_NAME;case"surname":return IFCConst.OID_SURNAME;case"givenname":return IFCConst.OID_GIVEN_NAME;case"countryname":case"c":return IFCConst.OID_COUNTRY_NAME;case"stateorprovincename":return IFCConst.OID_STATE_OR_PROVINCE_NAME;case"localityname":case"l":return IFCConst.OID_LOCALITY_NAME;case"streetaddress":case"street":return IFCConst.OID_STREET_ADDRESS;case"organizationname":case"o":return IFCConst.OID_ORGANIZATION_NAME;case"organizationunitname":case"ou":return IFCConst.OID_ORGANIZATION_UNIT_NAME;case"title":return IFCConst.OID_TITLE;case"emailaddress":case"email":return IFCConst.OID_EMAIL_ADDRESS;case"ogrn":return IFCConst.OID_OGRN;case"snils":return IFCConst.OID_SNILS;case"inn":return IFCConst.OID_INN;default:return t}},r=t.split("\\,").join("[escaped_comma]").split(e);this.dnData=new Object;for(var i=0;i<r.length;i++){var o=r[i].split("=");null==o[1]&&(o[1]="");var s=o[0].trim(),a=o[1].trim().split("[escaped_comma]").join(",");this.dnData[n(s)]=a}this.getCommonName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COMMON_NAME])},this.getSurname=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SURNAME])},this.getGivenName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_GIVEN_NAME])},this.getCountryName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_COUNTRY_NAME])},this.getStateOrProvinceName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STATE_OR_PROVINCE_NAME])},this.getLocalityName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_LOCALITY_NAME])},this.getStreetAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_STREET_ADDRESS])},this.getOrganizationName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_NAME])},this.getOrganizationUnitName=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_ORGANIZATION_UNIT_NAME])},this.getTitle=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_TITLE])},this.getEmailAddress=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_EMAIL_ADDRESS])},this.getOGRN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_OGRN])},this.getSNILS=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_SNILS])},this.getINN=function(){return IFCConst.emptyString(this.dnData[IFCConst.OID_INN])},this.getValueByOid=function(t){return IFCConst.emptyString(this.dnData[n(t)])},this.getSubjectArray=function(){var t=new Object,e=0;for(var n in this.dnData)t["oid_"+ ++e]=n,t["oid_type_"+e]=IFCConst.getDNDataType(n),t["value_"+e]=this.dnData[n];return t.oids_count=e,t},this.getOneLine=function(){var t="";return this.getCountryName()&&(t+="c="+this.getCountryName()+", "),this.getStateOrProvinceName()&&(t+="stateorprovincename="+this.getStateOrProvinceName()+", "),this.getLocalityName()&&(t+="l="+this.getLocalityName()+", "),this.getCommonName()&&(t+="cn="+this.getCommonName()+", "),this.getSurname()&&(t+="surname="+this.getSurname()+", "),this.getGivenName()&&(t+="givenname="+this.getGivenName()+", "),this.getStreetAddress()&&(t+="street="+this.getStreetAddress()+", "),this.getOrganizationName()&&(t+="o="+this.getOrganizationName()+", "),this.getOrganizationUnitName()&&(t+="ou="+this.getOrganizationUnitName()+", "),this.getTitle()&&(t+="title="+this.getTitle()+", "),this.getEmailAddress()&&(t+="email="+this.getEmailAddress()+", "),this.getOGRN()&&(t+="ogrn="+this.getOGRN()+", "),this.getSNILS()&&(t+="snils="+this.getSNILS()+", "),this.getINN()&&(t+="inn="+this.getINN()+", "),t.substring(0,t.length-2)}},t.IFCCertificateRequest=function(t,e){this.getContainerId=function(){return t},this.getCsr=function(){return e}},t.IFCEncrypted=function(t,e,n){this.getData=function(){return t},this.getKey=function(){return e},this.getCertificate=function(){return n}},t.IFCHash=function(t){this.getBase64=function(){return t},this.getHexBinary=function(){return n(e(t))},this.getPlainData=function(){return e(t)};var e=function(t){var e,n={},r=[],i="",o=String.fromCharCode,s=[[65,91],[97,123],[48,58],[43,44],[47,48]];for(z in s)for(e=s[z][0];e<s[z][1];e++)r.push(o(e));for(e=0;e<64;e++)n[r[e]]=e;for(e=0;e<t.length;e+=72){var a,c=0,u=0,l=t.substring(e,e+72);for(a=0;a<l.length;a++)for(c=(c<<6)+n[l.charAt(a)],u+=6;u>=8;)i+=o((c>>>(u-=8))%256)}return i},n=function(t){for(var e,n=[],r="",i=0,o=t.length;i<o;++i)e=t.charCodeAt(i),n.push((e>>4).toString(16),(15&e).toString(16));for(String.prototype.concat.apply("",n),i=0;i<n.length;i++)r+=n[i];return r}},t.IFCConst={IFC_DATATYPE_DATA:1,IFC_DATATYPE_DATA_BASE64:2,IFC_DATATYPE_HASH:3,IFC_DATATYPE_HASH_BASE64:4,IFC_DATATYPE_FILENAME:5,IFC_CRYPTO_PKCS11:"pkcs11",IFC_CRYPTO_CAPI:"capi",IFC_CRYPTO_CAPI_LINUX:"capi_linux",OID_COMMON_NAME:"2.5.4.3",OID_SURNAME:"2.5.4.4",OID_GIVEN_NAME:"2.5.4.42",OID_COUNTRY_NAME:"2.5.4.6",OID_STATE_OR_PROVINCE_NAME:"2.5.4.8",OID_LOCALITY_NAME:"2.5.4.7",OID_STREET_ADDRESS:"2.5.4.9",OID_ORGANIZATION_NAME:"2.5.4.10",OID_ORGANIZATION_UNIT_NAME:"2.5.4.11",OID_TITLE:"2.5.4.12",OID_EMAIL_ADDRESS:"1.2.840.113549.1.9.1",OID_OGRN:"1.2.643.100.1",OID_SNILS:"1.2.643.100.3",OID_INN:"1.2.643.3.131.1.1",OID_KC1:"1.2.643.100.113.1",OID_KC2:"1.2.643.100.113.2",OID_KC3:"1.2.643.100.113.3",OID_GOSTR3410_2001:"1.2.643.2.2.19",OID_GOSTR3410_2012_256:"1.2.643.7.1.1.1.1",OID_GOSTR3410_2012_512:"1.2.643.7.1.1.1.2",DN_SEPARATOR_PLUGIN:"\n",DN_SEPARATOR_INPUT:",",IFC_CERT_LOAD_FROM_CONTAINER:1,IFC_CERT_LOAD_FROM_FILE:2,IFC_CERT_LOAD_FROM_STRING:3,IFC_SIGNTYPE_SIMPLE:1,IFC_SIGNTYPE_SIMPLE_REVERSE:2,IFC_SIGNTYPE_CMS_ATTACHED:3,IFC_SIGNTYPE_CMS_DETACHED:4,IFC_SIGNTYPE_CADES_BES_ATTACHED:5,IFC_SIGNTYPE_CADES_BES_DETACHED:6,IFC_HARDWARE_HASH:1,IFC_SOFTWARE_HASH:2,IFC_BASE64:1,IFC_RAW:0,IFC_SHOW_CSP_UI:1,IFC_HIDE_CSP_UI:0,IFC_X509_INFO_CERT_BASE64ENCODED:1,IFC_X509_INFO_CERT_DER:2,IFC_X509_INFO_CERT_VERSION:3,IFC_X509_INFO_CERT_SERIALNUMBER:4,IFC_X509_INFO_CERT_SUBJECT:5,IFC_X509_INFO_CERT_ISSUER:6,IFC_X509_INFO_CERT_VALIDFROM:7,IFC_X509_INFO_CERT_VALIDTO:8,IFC_X509_INFO_CERT_X509EXTENSIONS:9,IFC_X509_INFO_CERT_PEM:10,IFC_X509_INFO_CERT_ALG:11,IFC_CERT_UNKNOWN:0,IFC_CERT_DER:1,IFC_CERT_BASE64:2,IFC_CERT_PEM:3,IFC_REQ_DER:0,IFC_REQ_PEM:1,IFC_REQ_BASE64ENCODED:2,P11_PIN_TYPE_USER:0,P11_PIN_TYPE_ADMIN:1,IFC_PRINTABLE_STRING:19,IFC_IA5STRING:22,IFC_NUMERICSTRING:18,IFC_UTF8STRING:12,IFC_OCTET_STRING:4,IFC_BMPSTRING:30,APDU_FORMAT_RAW:0,APDU_FORMAT_TEXT:1,SHOW_SAFETOUCH:0,getDNDataType:function(t){var e;switch(t){case this.OID_COUNTRY_NAME:e=this.IFC_PRINTABLE_STRING;break;case this.OID_SNILS:case this.OID_OGRN:case this.OID_INN:e=this.IFC_NUMERICSTRING;break;case this.OID_EMAIL_ADDRESS:e=this.IFC_IA5STRING;break;default:e=IFCConst.IFC_UTF8STRING}return e},emptyString:function(t){return null==t?"":t}},t.IFCError={IFC_GENERAL_ERROR:-1,IFC_OK:0,IFC_ERROR_UNKNOWN:1,IFC_ERROR_CONFIG:2,IFC_ERROR_RECORD_MAX:3,IFC_ERROR_CONFIG_EMPTY:4,IFC_BAD_PARAMS:5,IFC_ERROR_MALLOC:6,IFC_ALIAS_NOT_FOUND:7,IFC_ERROR_STORE:8,IFC_CERT_NOT_FOUND:9,IFC_CONTAINER_NOT_FOUND:10,IFC_UNSUPPORTED_FORMAT:11,IFC_KEY_NOT_FOUND:12,IFC_BAD_IN_TYPE:13,IFC_BAD_SIGN_TYPE:14,IFC_BAD_HASH_CONTEXT:15,IFC_BAD_TYPE_PIN:16,IFC_NOT_SUPPORTED:17,IFC_SLOT_NOT_INIT:18,IFC_ERROR_VERIFY:19,IFC_ERROR_BASE64:20,IFC_SC_ERROR:21,IFC_ENGINE_ERROR:22,IFC_P11_ERROR:23,IFC_P11_NO_TOKENS_FOUND:25,IFC_PARSE_XML_ERROR:26,IFC_XPATH_ERROR:27,IFC_CANON_XML_ERROR:28,IFC_P11_LOGIN_ERROR:160,IFC_UNICODE_ERROR:161,IFC_ENCODINGS_ERROR:162,IFC_INIT_ERROR:163,IFC_CRYPTO_NOT_FOUND:164,IFC_PLUGIN_UNDEFINED_ERROR:256,IFC_P11_INVALID_PIN_ERROR:257,getErrorDescription:function(t){switch(t){case IFCError.IFC_GENERAL_ERROR:return"\u041e\u0431\u0449\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430";case IFCError.IFC_OK:return"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e";case IFCError.IFC_ERROR_UNKNOWN:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043d\u0435 \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430";case IFCError.IFC_ERROR_CONFIG:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438";case IFCError.IFC_ERROR_RECORD_MAX:return"\u0414\u043e\u0441\u0442\u0438\u0433\u043d\u0443\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0435 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0437\u0430\u043f\u0438\u0441\u0435\u0439 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438";case IFCError.IFC_ERROR_CONFIG_EMPTY:return"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043e\u043f\u0435\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u0430";case IFCError.IFC_BAD_PARAMS:return"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u0437\u0430\u0434\u0430\u043d\u044b \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_ERROR_MALLOC:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u0434\u0435\u043b\u0435\u043d\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438";case IFCError.IFC_ALIAS_NOT_FOUND:return"\u0423\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0439 \u043f\u043e\u0441\u0442\u0430\u0432\u0449\u0438\u043a \u043a\u0440\u0438\u043f\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u0438 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_ERROR_STORE:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0445\u0440\u0430\u043d\u0438\u043b\u0438\u0449\u0435\u043c";case IFCError.IFC_CERT_NOT_FOUND:return"\u0421\u0435\u0440\u0442\u0438\u0444\u0438\u043a\u0430\u0442 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_CONTAINER_NOT_FOUND:return"\u041a\u043b\u044e\u0447\u0435\u0432\u043e\u0439 \u043a\u043e\u043d\u0442\u0435\u0439\u043d\u0435\u0440 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_UNSUPPORTED_FORMAT:return"\u0424\u043e\u0440\u043c\u0430\u0442 \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f";case IFCError.IFC_KEY_NOT_FOUND:return"\u041a\u043b\u044e\u0447 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_BAD_IN_TYPE:return"\u0422\u0438\u043f \u0432\u0445\u043e\u0434\u043d\u044b\u0445 \u0434\u0430\u043d\u043d\u044b\u0445 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_BAD_SIGN_TYPE:return"\u0422\u0438\u043f \u044d\u043b\u0435\u043a\u0442\u0440\u043e\u043d\u043d\u043e\u0439 \u043f\u043e\u0434\u043f\u0438\u0441\u0438 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_BAD_HASH_CONTEXT:return"\u041a\u043e\u043d\u0442\u0435\u043a\u0441\u0442 \u0445\u0435\u0448\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d";case IFCError.IFC_BAD_TYPE_PIN:return"\u0422\u0438\u043f \u043f\u0438\u043d-\u043a\u043e\u0434\u0430 \u0437\u0430\u0434\u0430\u043d \u043d\u0435\u0432\u0435\u0440\u043d\u043e";case IFCError.IFC_NOT_SUPPORTED:return"\u041e\u043f\u0435\u0440\u0430\u0446\u0438\u044f \u043d\u0435 \u043f\u043e\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u0435\u0442\u0441\u044f";case IFCError.IFC_SLOT_NOT_INIT:return"\u0421\u043b\u043e\u0442 \u043d\u0435 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0438\u0440\u043e\u0432\u0430\u043d";case IFCError.IFC_ERROR_VERIFY:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0438 \u043f\u043e\u0434\u043f\u0438\u0441\u0438";case IFCError.IFC_ERROR_BASE64:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438 BASE64";case IFCError.IFC_SC_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u043e\u0434\u0441\u0438\u0441\u0442\u0435\u043c\u044b \u0441\u043c\u0430\u0440\u0442-\u043a\u0430\u0440\u0442";case IFCError.IFC_ENGINE_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430";case IFCError.IFC_P11_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 \u0431\u0438\u0431\u043b\u0438\u043e\u0442\u0435\u043a\u043e\u0439 PKCS#11";case IFCError.IFC_P11_NO_TOKENS_FOUND:return"\u0421\u043c\u0430\u0440\u0442-\u043a\u0430\u0440\u0442\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430";case IFCError.IFC_PARSE_XML_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043f\u0430\u0440\u0441\u0438\u043d\u0433\u0430 XML";case IFCError.IFC_XPATH_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0432\u044b\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f XPath";case IFCError.IFC_CANON_XML_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u0430\u043d\u043e\u043d\u0438\u0437\u0430\u0446\u0438\u0438 XML";case IFCError.IFC_P11_LOGIN_ERROR:return"\u041d\u0435\u0432\u0435\u0440\u043d\u044b\u0439 \u043f\u0438\u043d-\u043a\u043e\u0434";case IFCError.IFC_UNICODE_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b \u0441 UNICODE";case IFCError.IFC_ENCODINGS_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u043a\u043e\u0434\u0438\u0440\u043e\u0432\u043a\u0438";case IFCError.IFC_INIT_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043f\u043b\u0430\u0433\u0438\u043d\u0430";case IFCError.IFC_CRYPTO_NOT_FOUND:return"\u0421\u041a\u0417\u0418 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u043e";case IFCError.IFC_PLUGIN_UNDEFINED_ERROR:return"\u041e\u0448\u0438\u0431\u043a\u0430 \u0438\u043d\u0438\u0446\u0438\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u043f\u043b\u0430\u0433\u0438\u043d\u0430";case IFCError.IFC_P11_INVALID_PIN_ERROR:return"\u041f\u0438\u043d-\u043a\u043e\u0434 \u043d\u0435 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043d\u0438\u044f\u043c";default:return"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043d\u0430\u044f \u043e\u0448\u0438\u0431\u043a\u0430"}}},"function"!=typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")})}(window)},QAZZ:function(t,e,n){var r=n("Rb7d");function i(t,e){var n=t.a/255,r=e+'="'+t.hex+'"';return n<1?r+" "+e+'-opacity="'+n.toFixed(2).slice(1)+'"':r}function o(t,e,n){var r=t+e;return void 0!==n&&(r+=" "+n),r}e.render=function(t,e,n){var s=r.getOptions(e),a=t.modules.size,c=t.modules.data,u=a+2*s.margin,l=s.color.light.a?"<path "+i(s.color.light,"fill")+' d="M0 0h'+u+"v"+u+'H0z"/>':"",d="<path "+i(s.color.dark,"stroke")+' d="'+function(t,e,n){for(var r="",i=0,s=!1,a=0,c=0;c<t.length;c++){var u=Math.floor(c%e),l=Math.floor(c/e);u||s||(s=!0),t[c]?(a++,c>0&&u>0&&t[c-1]||(r+=s?o("M",u+n,.5+l+n):o("m",i,0),i=0,s=!1),u+1<e&&t[c+1]||(r+=o("h",a),a=0)):i++}return r}(c,a,s.margin)+'"/>',h='<svg xmlns="http://www.w3.org/2000/svg" '+(s.width?'width="'+s.width+'" height="'+s.width+'" ':"")+'viewBox="0 0 '+u+" "+u+'" shape-rendering="crispEdges">'+l+d+"</svg>\n";return"function"==typeof n&&n(null,h),h}},QUaw:function(t,e,n){var r=n("Rb7d");e.render=function(t,e,n){var i=n,o=e;void 0!==i||e&&e.getContext||(i=e,e=void 0),e||(o=function(){try{return document.createElement("canvas")}catch(t){throw new Error("You need to specify a canvas element")}}()),i=r.getOptions(i);var s=r.getImageWidth(t.modules.size,i),a=o.getContext("2d"),c=a.createImageData(s,s);return r.qrToImageData(c.data,t,i),function(t,e,n){t.clearRect(0,0,e.width,e.height),e.style||(e.style={}),e.height=n,e.width=n,e.style.height=n+"px",e.style.width=n+"px"}(a,o,s),a.putImageData(c,0,0),o},e.renderToDataURL=function(t,n,r){var i=r;return void 0!==i||n&&n.getContext||(i=n,n=void 0),i||(i={}),e.render(t,n,i).toDataURL(i.type||"image/png",(i.rendererOpts||{}).quality)}},Rb7d:function(t,e){function n(t){if("number"==typeof t&&(t=t.toString()),"string"!=typeof t)throw new Error("Color should be defined as hex string");var e=t.slice().replace("#","").split("");if(e.length<3||5===e.length||e.length>8)throw new Error("Invalid hex color: "+t);3!==e.length&&4!==e.length||(e=Array.prototype.concat.apply([],e.map((function(t){return[t,t]})))),6===e.length&&e.push("F","F");var n=parseInt(e.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:255&n,hex:"#"+e.slice(0,6).join("")}}e.getOptions=function(t){t||(t={}),t.color||(t.color={});var e=t.width&&t.width>=21?t.width:void 0;return{width:e,scale:e?4:t.scale||4,margin:null==t.margin||t.margin<0?4:t.margin,color:{dark:n(t.color.dark||"#000000ff"),light:n(t.color.light||"#ffffffff")},type:t.type,rendererOpts:t.rendererOpts||{}}},e.getScale=function(t,e){return e.width&&e.width>=t+2*e.margin?e.width/(t+2*e.margin):e.scale},e.getImageWidth=function(t,n){var r=e.getScale(t,n);return Math.floor((t+2*n.margin)*r)},e.qrToImageData=function(t,n,r){for(var i=n.modules.size,o=n.modules.data,s=e.getScale(i,r),a=Math.floor((i+2*r.margin)*s),c=r.margin*s,u=[r.color.light,r.color.dark],l=0;l<a;l++)for(var d=0;d<a;d++){var h=4*(l*a+d),g=r.color.light;l>=c&&d>=c&&l<a-c&&d<a-c&&(g=u[o[Math.floor((l-c)/s)*i+Math.floor((d-c)/s)]?1:0]),t[h++]=g.r,t[h++]=g.g,t[h++]=g.b,t[h]=g.a}}},V35J:function(t,e,n){var r=n("Wogr");function i(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new r(t*t),this.data.fill(0),this.reservedBit=new r(t*t),this.reservedBit.fill(0)}i.prototype.set=function(t,e,n,r){var i=t*this.size+e;this.data[i]=n,r&&(this.reservedBit[i]=!0)},i.prototype.get=function(t,e){return this.data[t*this.size+e]},i.prototype.xor=function(t,e,n){this.data[t*this.size+e]^=n},i.prototype.isReserved=function(t,e){return this.reservedBit[t*this.size+e]},t.exports=i},Wogr:function(t,e,n){"use strict";var r=n("7uVY"),i=(o.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()}catch(e){return!1}}())?2147483647:1073741823;function o(t,e,n){return o.TYPED_ARRAY_SUPPORT||this instanceof o?"number"==typeof t?c(this,t):function(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,n,r){if(n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");var i;return i=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),o.TYPED_ARRAY_SUPPORT?i.__proto__=o.prototype:i=u(t,i),i}(t,e,n,r):"string"==typeof e?function(t,e){var n=0|d(e),r=a(t,n),i=r.write(e);return i!==n&&(r=r.slice(0,i)),r}(t,e):function(t,e){if(o.isBuffer(e)){var n=0|s(e.length),r=a(t,n);return 0===r.length||e.copy(r,0,0,n),r}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(i=e.length)!=i?a(t,0):u(t,e);if("Buffer"===e.type&&Array.isArray(e.data))return u(t,e.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}(this,t,e,n):new o(t,e,n)}function s(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function a(t,e){var n;return o.TYPED_ARRAY_SUPPORT?(n=new Uint8Array(e)).__proto__=o.prototype:(null===(n=t)&&(n=new o(e)),n.length=e),n}function c(t,e){var n=a(t,e<0?0:0|s(e));if(!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<e;++r)n[r]=0;return n}function u(t,e){for(var n=e.length<0?0:0|s(e.length),r=a(t,n),i=0;i<n;i+=1)r[i]=255&e[i];return r}function l(t,e){var n;e=e||1/0;for(var r=t.length,i=null,o=[],s=0;s<r;++s){if((n=t.charCodeAt(s))>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function d(t){return o.isBuffer(t)?t.length:"undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer)?t.byteLength:("string"!=typeof t&&(t=""+t),0===t.length?0:l(t).length)}o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1})),o.prototype.write=function(t,e,n){void 0===e||void 0===n&&"string"==typeof e?(n=this.length,e=0):isFinite(e)&&(e|=0,isFinite(n)?n|=0:n=void 0);var r=this.length-e;if((void 0===n||n>r)&&(n=r),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");return function(t,e,n,r){return function(t,e,n,r){for(var i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}(l(e,t.length-n),t,n,r)}(this,t,e,n)},o.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),o.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=o.prototype;else{var i=e-t;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+t]}return n},o.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var i,s=r-n;if(this===t&&n<e&&e<r)for(i=s-1;i>=0;--i)t[i+e]=this[i+n];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)t[i+e]=this[i+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+s),e);return s},o.prototype.fill=function(t,e,n){if("string"==typeof t){if("string"==typeof e?(e=0,n=this.length):"string"==typeof n&&(n=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var s=o.isBuffer(t)?t:new o(t),a=s.length;for(i=0;i<n-e;++i)this[i+e]=s[i%a]}return this},o.concat=function(t,e){if(!r(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a(null,0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var i=c(null,e),s=0;for(n=0;n<t.length;++n){var u=t[n];if(!o.isBuffer(u))throw new TypeError('"list" argument must be an Array of Buffers');u.copy(i,s),s+=u.length}return i},o.byteLength=d,o.prototype._isBuffer=!0,o.isBuffer=function(t){return!(null==t||!t._isBuffer)},t.exports=o},Z92M:function(t,e){t.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},aZ40:function(t,e,n){var r,i,o=n("Wogr");o.alloc?(r=o.alloc(512),i=o.alloc(256)):(r=new o(512),i=new o(256)),function(){for(var t=1,e=0;e<255;e++)r[e]=t,i[t]=e,256&(t<<=1)&&(t^=285);for(e=255;e<512;e++)r[e]=r[e-255]}(),e.log=function(t){if(t<1)throw new Error("log("+t+")");return i[t]},e.exp=function(t){return r[t]},e.mul=function(t,e){return 0===t||0===e?0:r[i[t]+i[e]]}},"e/Dd":function(t,e){var n,r=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];e.getSymbolSize=function(t){if(!t)throw new Error('"version" cannot be null or undefined');if(t<1||t>40)throw new Error('"version" should be in range from 1 to 40');return 4*t+17},e.getSymbolTotalCodewords=function(t){return r[t]},e.getBCHDigit=function(t){for(var e=0;0!==t;)e++,t>>>=1;return e},e.setToSJISFunction=function(t){if("function"!=typeof t)throw new Error('"toSJISFunc" is not a valid function.');n=t},e.isKanjiModeEnabled=function(){return void 0!==n},e.toSJIS=function(t){return n(t)}},e6BP:function(t,e){function n(){this.buffer=[],this.length=0}n.prototype={get:function(t){var e=Math.floor(t/8);return 1==(this.buffer[e]>>>7-t%8&1)},put:function(t,e){for(var n=0;n<e;n++)this.putBit(1==(t>>>e-n-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},t.exports=n},eQOe:function(t,e){function n(t,n,r){switch(t){case e.Patterns.PATTERN000:return(n+r)%2==0;case e.Patterns.PATTERN001:return n%2==0;case e.Patterns.PATTERN010:return r%3==0;case e.Patterns.PATTERN011:return(n+r)%3==0;case e.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(r/3))%2==0;case e.Patterns.PATTERN101:return n*r%2+n*r%3==0;case e.Patterns.PATTERN110:return(n*r%2+n*r%3)%2==0;case e.Patterns.PATTERN111:return(n*r%3+(n+r)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}}e.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},e.isValid=function(t){return null!=t&&""!==t&&!isNaN(t)&&t>=0&&t<=7},e.from=function(t){return e.isValid(t)?parseInt(t,10):void 0},e.getPenaltyN1=function(t){for(var e=t.size,n=0,r=0,i=0,o=null,s=null,a=0;a<e;a++){r=i=0,o=s=null;for(var c=0;c<e;c++){var u=t.get(a,c);u===o?r++:(r>=5&&(n+=r-5+3),o=u,r=1),(u=t.get(c,a))===s?i++:(i>=5&&(n+=i-5+3),s=u,i=1)}r>=5&&(n+=r-5+3),i>=5&&(n+=i-5+3)}return n},e.getPenaltyN2=function(t){for(var e=t.size,n=0,r=0;r<e-1;r++)for(var i=0;i<e-1;i++){var o=t.get(r,i)+t.get(r,i+1)+t.get(r+1,i)+t.get(r+1,i+1);4!==o&&0!==o||n++}return 3*n},e.getPenaltyN3=function(t){for(var e=t.size,n=0,r=0,i=0,o=0;o<e;o++){r=i=0;for(var s=0;s<e;s++)r=r<<1&2047|t.get(o,s),s>=10&&(1488===r||93===r)&&n++,i=i<<1&2047|t.get(s,o),s>=10&&(1488===i||93===i)&&n++}return 40*n},e.getPenaltyN4=function(t){for(var e=0,n=t.data.length,r=0;r<n;r++)e+=t.data[r];return 10*Math.abs(Math.ceil(100*e/n/5)-10)},e.applyMask=function(t,e){for(var r=e.size,i=0;i<r;i++)for(var o=0;o<r;o++)e.isReserved(o,i)||e.xor(o,i,n(t,o,i))},e.getBestMask=function(t,n){for(var r=Object.keys(e.Patterns).length,i=0,o=1/0,s=0;s<r;s++){n(s),e.applyMask(s,t);var a=e.getPenaltyN1(t)+e.getPenaltyN2(t)+e.getPenaltyN3(t)+e.getPenaltyN4(t);e.applyMask(s,t),a<o&&(o=a,i=s)}return i}},ekOh:function(t,e){e.L={bit:1},e.M={bit:0},e.Q={bit:3},e.H={bit:2},e.isValid=function(t){return t&&void 0!==t.bit&&t.bit>=0&&t.bit<4},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"l":case"low":return e.L;case"m":case"medium":return e.M;case"q":case"quartile":return e.Q;case"h":case"high":return e.H;default:throw new Error("Unknown EC Level: "+t)}}(t)}catch(r){return n}}},jSPq:function(t,e,n){var r=n("Wogr"),i=n("JzKC");function o(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}o.prototype.initialize=function(t){this.degree=t,this.genPoly=i.generateECPolynomial(this.degree)},o.prototype.encode=function(t){if(!this.genPoly)throw new Error("Encoder not initialized");var e=new r(this.degree);e.fill(0);var n=r.concat([t,e],t.length+this.degree),o=i.mod(n,this.genPoly),s=this.degree-o.length;if(s>0){var a=new r(this.degree);return a.fill(0),o.copy(a,s),a}return o},t.exports=o},"kk9/":function(t,e,n){var r=n("e/Dd").getSymbolSize;e.getPositions=function(t){var e=r(t);return[[0,0],[e-7,0],[0,e-7]]}},lYJp:function(t,e,n){var r=n("e/Dd"),i=r.getBCHDigit(1335);e.getEncodedBits=function(t,e){for(var n=t.bit<<3|e,o=n<<10;r.getBCHDigit(o)-i>=0;)o^=1335<<r.getBCHDigit(o)-i;return 21522^(n<<10|o)}},nZSm:function(t,e,n){var r=n("u/Db"),i=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function o(t){this.mode=r.ALPHANUMERIC,this.data=t}o.getBitsLength=function(t){return 11*Math.floor(t/2)+t%2*6},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(t){var e;for(e=0;e+2<=this.data.length;e+=2){var n=45*i.indexOf(this.data[e]);n+=i.indexOf(this.data[e+1]),t.put(n,11)}this.data.length%2&&t.put(i.indexOf(this.data[e]),6)},t.exports=o},qmMu:function(t,e,n){var r=n("Wogr"),i=n("e/Dd"),o=n("ekOh"),s=n("e6BP"),a=n("V35J"),c=n("1sBl"),u=n("kk9/"),l=n("eQOe"),d=n("NPxG"),h=n("jSPq"),g=n("yKow"),p=n("lYJp"),f=n("u/Db"),C=n("vvrf"),I=n("7uVY");function _(t,e,n){var r,i,o=t.size,s=p.getEncodedBits(e,n);for(r=0;r<15;r++)t.set(r<6?r:r<8?r+1:o-15+r,8,i=1==(s>>r&1),!0),t.set(8,r<8?o-r-1:r<9?15-r-1+1:15-r-1,i,!0);t.set(o-8,8,1,!0)}e.create=function(t,e){if(void 0===t||""===t)throw new Error("No input text");var n,p,m=o.M;return void 0!==e&&(m=o.from(e.errorCorrectionLevel,o.M),n=g.from(e.version),p=l.from(e.maskPattern),e.toSJISFunc&&i.setToSJISFunction(e.toSJISFunc)),function(t,e,n,o){var p;if(I(t))p=C.fromArray(t);else{if("string"!=typeof t)throw new Error("Invalid data");var m=e;if(!m){var E=C.rawSplit(t);m=g.getBestVersionForData(E,n)}p=C.fromString(t,m||40)}var S=g.getBestVersionForData(p,n);if(!S)throw new Error("The amount of data is too big to be stored in a QR Code");if(e){if(e<S)throw new Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+S+".\n")}else e=S;var v=function(t,e,n){var o=new s;n.forEach((function(e){o.put(e.mode.bit,4),o.put(e.getLength(),f.getCharCountIndicator(e.mode,t)),e.write(o)}));var a=8*(i.getSymbolTotalCodewords(t)-d.getTotalCodewordsCount(t,e));for(o.getLengthInBits()+4<=a&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(0);for(var c=(a-o.getLengthInBits())/8,u=0;u<c;u++)o.put(u%2?17:236,8);return function(t,e,n){for(var o=i.getSymbolTotalCodewords(e),s=o-d.getTotalCodewordsCount(e,n),a=d.getBlocksCount(e,n),c=a-o%a,u=Math.floor(o/a),l=Math.floor(s/a),g=l+1,p=u-l,f=new h(p),C=0,I=new Array(a),_=new Array(a),m=0,E=new r(t.buffer),S=0;S<a;S++){var v=S<c?l:g;I[S]=E.slice(C,C+v),_[S]=f.encode(I[S]),C+=v,m=Math.max(m,v)}var F,T,y=new r(o),A=0;for(F=0;F<m;F++)for(T=0;T<a;T++)F<I[T].length&&(y[A++]=I[T][F]);for(F=0;F<p;F++)for(T=0;T<a;T++)y[A++]=_[T][F];return y}(o,t,e)}(e,n,p),F=i.getSymbolSize(e),T=new a(F);return function(t,e){for(var n=t.size,r=u.getPositions(e),i=0;i<r.length;i++)for(var o=r[i][0],s=r[i][1],a=-1;a<=7;a++)if(!(o+a<=-1||n<=o+a))for(var c=-1;c<=7;c++)s+c<=-1||n<=s+c||t.set(o+a,s+c,a>=0&&a<=6&&(0===c||6===c)||c>=0&&c<=6&&(0===a||6===a)||a>=2&&a<=4&&c>=2&&c<=4,!0)}(T,e),function(t){for(var e=t.size,n=8;n<e-8;n++){var r=n%2==0;t.set(n,6,r,!0),t.set(6,n,r,!0)}}(T),function(t,e){for(var n=c.getPositions(e),r=0;r<n.length;r++)for(var i=n[r][0],o=n[r][1],s=-2;s<=2;s++)for(var a=-2;a<=2;a++)t.set(i+s,o+a,-2===s||2===s||-2===a||2===a||0===s&&0===a,!0)}(T,e),_(T,n,0),e>=7&&function(t,e){for(var n,r,i,o=t.size,s=g.getEncodedBits(e),a=0;a<18;a++)n=Math.floor(a/3),t.set(n,r=a%3+o-8-3,i=1==(s>>a&1),!0),t.set(r,n,i,!0)}(T,e),function(t,e){for(var n=t.size,r=-1,i=n-1,o=7,s=0,a=n-1;a>0;a-=2)for(6===a&&a--;;){for(var c=0;c<2;c++)if(!t.isReserved(i,a-c)){var u=!1;s<e.length&&(u=1==(e[s]>>>o&1)),t.set(i,a-c,u),-1==--o&&(s++,o=7)}if((i+=r)<0||n<=i){i-=r,r=-r;break}}}(T,v),isNaN(o)&&(o=l.getBestMask(T,_.bind(null,T,n))),l.applyMask(o,T),_(T,n,o),{modules:T,version:e,errorCorrectionLevel:n,maskPattern:o,segments:p}}(t,n,m,p)}},"u/Db":function(t,e,n){var r=n("J6Nv"),i=n("BCVQ");e.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},e.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},e.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},e.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},e.MIXED={bit:-1},e.getCharCountIndicator=function(t,e){if(!t.ccBits)throw new Error("Invalid mode: "+t);if(!r.isValid(e))throw new Error("Invalid version: "+e);return e>=1&&e<10?t.ccBits[0]:e<27?t.ccBits[1]:t.ccBits[2]},e.getBestModeForData=function(t){return i.testNumeric(t)?e.NUMERIC:i.testAlphanumeric(t)?e.ALPHANUMERIC:i.testKanji(t)?e.KANJI:e.BYTE},e.toString=function(t){if(t&&t.id)return t.id;throw new Error("Invalid mode")},e.isValid=function(t){return t&&t.bit&&t.ccBits},e.from=function(t,n){if(e.isValid(t))return t;try{return function(t){if("string"!=typeof t)throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return e.NUMERIC;case"alphanumeric":return e.ALPHANUMERIC;case"kanji":return e.KANJI;case"byte":return e.BYTE;default:throw new Error("Unknown mode: "+t)}}(t)}catch(r){return n}}},vvrf:function(t,e,n){var r=n("u/Db"),i=n("3X7Y"),o=n("nZSm"),s=n("AZa5"),a=n("Lzq4"),c=n("BCVQ"),u=n("e/Dd"),l=n("ELBg");function d(t){return unescape(encodeURIComponent(t)).length}function h(t,e,n){for(var r,i=[];null!==(r=t.exec(n));)i.push({data:r[0],index:r.index,mode:e,length:r[0].length});return i}function g(t){var e,n,i=h(c.NUMERIC,r.NUMERIC,t),o=h(c.ALPHANUMERIC,r.ALPHANUMERIC,t);return u.isKanjiModeEnabled()?(e=h(c.BYTE,r.BYTE,t),n=h(c.KANJI,r.KANJI,t)):(e=h(c.BYTE_KANJI,r.BYTE,t),n=[]),i.concat(o,e,n).sort((function(t,e){return t.index-e.index})).map((function(t){return{data:t.data,mode:t.mode,length:t.length}}))}function p(t,e){switch(e){case r.NUMERIC:return i.getBitsLength(t);case r.ALPHANUMERIC:return o.getBitsLength(t);case r.KANJI:return a.getBitsLength(t);case r.BYTE:return s.getBitsLength(t)}}function f(t,e){var n,c=r.getBestModeForData(t);if((n=r.from(e,c))!==r.BYTE&&n.bit<c.bit)throw new Error('"'+t+'" cannot be encoded with mode '+r.toString(n)+".\n Suggested mode is: "+r.toString(c));switch(n!==r.KANJI||u.isKanjiModeEnabled()||(n=r.BYTE),n){case r.NUMERIC:return new i(t);case r.ALPHANUMERIC:return new o(t);case r.KANJI:return new a(t);case r.BYTE:return new s(t)}}e.fromArray=function(t){return t.reduce((function(t,e){return"string"==typeof e?t.push(f(e,null)):e.data&&t.push(f(e.data,e.mode)),t}),[])},e.fromString=function(t,n){for(var i=function(t,e){for(var n={},i={start:{}},o=["start"],s=0;s<t.length;s++){for(var a=t[s],c=[],u=0;u<a.length;u++){var l=a[u],d=""+s+u;c.push(d),n[d]={node:l,lastCount:0},i[d]={};for(var h=0;h<o.length;h++){var g=o[h];n[g]&&n[g].node.mode===l.mode?(i[g][d]=p(n[g].lastCount+l.length,l.mode)-p(n[g].lastCount,l.mode),n[g].lastCount+=l.length):(n[g]&&(n[g].lastCount=l.length),i[g][d]=p(l.length,l.mode)+4+r.getCharCountIndicator(l.mode,e))}}o=c}for(h=0;h<o.length;h++)i[o[h]].end=0;return{map:i,table:n}}(function(t){for(var e=[],n=0;n<t.length;n++){var i=t[n];switch(i.mode){case r.NUMERIC:e.push([i,{data:i.data,mode:r.ALPHANUMERIC,length:i.length},{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.ALPHANUMERIC:e.push([i,{data:i.data,mode:r.BYTE,length:i.length}]);break;case r.KANJI:e.push([i,{data:i.data,mode:r.BYTE,length:d(i.data)}]);break;case r.BYTE:e.push([{data:i.data,mode:r.BYTE,length:d(i.data)}])}}return e}(g(t,u.isKanjiModeEnabled())),n),o=l.find_path(i.map,"start","end"),s=[],a=1;a<o.length-1;a++)s.push(i.table[o[a]].node);return e.fromArray(s.reduce((function(t,e){var n=t.length-1>=0?t[t.length-1]:null;return n&&n.mode===e.mode?(t[t.length-1].data+=e.data,t):(t.push(e),t)}),[]))},e.rawSplit=function(t){return e.fromArray(g(t,u.isKanjiModeEnabled()))}},yKow:function(t,e,n){var r=n("e/Dd"),i=n("NPxG"),o=n("ekOh"),s=n("u/Db"),a=n("J6Nv"),c=n("7uVY"),u=r.getBCHDigit(7973);function l(t,e){return s.getCharCountIndicator(t,e)+4}function d(t,e){var n=0;return t.forEach((function(t){var r=l(t.mode,e);n+=r+t.getBitsLength()})),n}e.from=function(t,e){return a.isValid(t)?parseInt(t,10):e},e.getCapacity=function(t,e,n){if(!a.isValid(t))throw new Error("Invalid QR Code version");void 0===n&&(n=s.BYTE);var o=8*(r.getSymbolTotalCodewords(t)-i.getTotalCodewordsCount(t,e));if(n===s.MIXED)return o;var c=o-l(n,t);switch(n){case s.NUMERIC:return Math.floor(c/10*3);case s.ALPHANUMERIC:return Math.floor(c/11*2);case s.KANJI:return Math.floor(c/13);case s.BYTE:default:return Math.floor(c/8)}},e.getBestVersionForData=function(t,n){var r,i=o.from(n,o.M);if(c(t)){if(t.length>1)return function(t,n){for(var r=1;r<=40;r++)if(d(t,r)<=e.getCapacity(r,n,s.MIXED))return r}(t,i);if(0===t.length)return 1;r=t[0]}else r=t;return function(t,n,r){for(var i=1;i<=40;i++)if(n<=e.getCapacity(i,r,t))return i}(r.mode,r.getLength(),i)},e.getEncodedBits=function(t){if(!a.isValid(t)||t<7)throw new Error("Invalid QR Code version");for(var e=t<<12;r.getBCHDigit(e)-u>=0;)e^=7973<<r.getBCHDigit(e)-u;return t<<12|e}}}]);